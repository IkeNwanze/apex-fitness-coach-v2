This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.gitignore
app/api/generate-plan/route.ts
app/api/initialize-stats/route.ts
app/api/test-auth/route.ts
app/dashboard/page.tsx
app/dashboard/page.tsx.backup
app/favicon.ico
app/globals.css
app/layout.tsx
app/login/page.tsx
app/onboarding/page.tsx
app/page.tsx
app/photos/upload/page.tsx
app/plan/page.tsx
app/signup/page.tsx
app/test/page.tsx
components/AuthProvider.tsx
components/cyber/CyberButton.tsx
components/ThemeProvider.tsx
components/ThemeSwitcher.tsx
components/ui/Button.tsx
components/ui/Card.tsx
eslint.config.mjs
lib/supabaseClient.ts
lib/themes.ts
next-env.d.ts
next.config.ts
package.json
postcss.config.mjs
public/file.svg
public/globe.svg
public/next.svg
public/vercel.svg
public/window.svg
README.md
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="app/plan/page.tsx">
'use client'

import { useEffect, useState } from 'react'
import { useRouter } from 'next/navigation'
import { useAuth } from '@/components/AuthProvider'
import { useTheme } from '@/components/ThemeProvider'
import { supabaseBrowser } from '@/lib/supabaseClient'

interface UserPlan {
  id: string
  plan_json: any
  created_at: string
  status: string
}

export default function PlanPage() {
  const { user, loading: authLoading } = useAuth()
  const { themeConfig } = useTheme()
  const router = useRouter()
  
  const [plan, setPlan] = useState<UserPlan | null>(null)
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState<string | null>(null)
  const [currentWeek, setCurrentWeek] = useState(1)

  // Redirect if not logged in
  useEffect(() => {
    if (!authLoading && !user) {
      router.push('/login')
    }
  }, [user, authLoading, router])

  // Load user's plan
  useEffect(() => {
    async function loadPlan() {
      if (!user) return

      try {
        setLoading(true)
        setError(null)

        const { data, error: fetchError } = await supabaseBrowser
          .from('user_plans')
          .select('*')
          .eq('user_id', user.id)
          .eq('status', 'active')
          .order('created_at', { ascending: false })
          .limit(1)
          .single()

        if (fetchError) {
          if (fetchError.code === 'PGRST116') {
            // No plan found
            setError('No active plan found. Generate one from your dashboard!')
          } else {
            throw fetchError
          }
          return
        }

        setPlan(data)
      } catch (err: any) {
        console.error('Error loading plan:', err)
        setError(err.message || 'Failed to load plan')
      } finally {
        setLoading(false)
      }
    }

    loadPlan()
  }, [user])

  // Show loading state
  if (authLoading || loading) {
    return (
      <div 
        className="min-h-screen flex items-center justify-center"
        style={{ background: 'var(--bgPrimary)' }}
      >
        <div style={{ color: 'var(--textPrimary)' }}>
          Loading your plan...
        </div>
      </div>
    )
  }

  // Show error state
  if (error || !plan) {
    return (
      <div 
        className="min-h-screen p-8"
        style={{ background: 'var(--bgPrimary)' }}
      >
        <div className="max-w-4xl mx-auto">
          <div
            className="themed-card p-8 border-2 text-center"
            style={{
              backgroundColor: 'var(--bgCard)',
              borderColor: 'var(--borderColor)',
            }}
          >
            <h2 
              className="text-2xl font-bold mb-4"
              style={{ color: 'var(--textPrimary)' }}
            >
              {error || 'No plan found'}
            </h2>
            <button
              onClick={() => router.push('/dashboard')}
              className="px-6 py-3 rounded-lg font-bold transition-all duration-300"
              style={{
                background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                color: '#FFFFFF',
              }}
            >
              Go to Dashboard
            </button>
          </div>
        </div>
      </div>
    )
  }

  const planData = plan.plan_json
  const weeklyPlan = planData?.weekly_plan
  const totalWeeks = planData?.time_to_goal?.estimate_weeks_range?.max || 12

  return (
    <div 
      className="min-h-screen p-8 transition-all duration-500"
      style={{ background: 'var(--bgPrimary)' }}
    >
      <div className="max-w-6xl mx-auto space-y-8">
        
        {/* Header */}
        <div className="flex justify-between items-start">
          <div>
            <h1 
              className="text-4xl font-bold mb-2"
              style={{
                background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                backgroundClip: 'text',
              }}
            >
              Your Workout Plan
            </h1>
            <p style={{ color: 'var(--textSecondary)' }}>
              {weeklyPlan?.split_name || 'Custom Training Program'} ‚Ä¢ {weeklyPlan?.days_per_week || 4} days/week
            </p>
          </div>

          <button
            onClick={() => router.push('/dashboard')}
            className="px-6 py-3 rounded-lg font-bold border-2 transition-all duration-300 hover:opacity-80"
            style={{
              borderColor: 'var(--borderColor)',
              color: 'var(--textPrimary)',
            }}
          >
            ‚Üê Back to Dashboard
          </button>
        </div>

        {/* Week Navigation */}
        <div
          className="themed-card p-6 border-2"
          style={{
            backgroundColor: 'var(--bgCard)',
            borderColor: 'var(--borderColor)',
          }}
        >
          <div className="flex items-center justify-between">
            <button
              onClick={() => setCurrentWeek(Math.max(1, currentWeek - 1))}
              disabled={currentWeek === 1}
              className="px-4 py-2 rounded-lg font-bold border-2 transition-all duration-300 disabled:opacity-30"
              style={{
                borderColor: 'var(--borderColor)',
                color: 'var(--textPrimary)',
              }}
            >
              ‚Üê Previous Week
            </button>

            <div className="text-center">
              <h2 
                className="text-2xl font-bold"
                style={{ color: 'var(--accent1)' }}
              >
                Week {currentWeek}
              </h2>
              <p className="text-sm" style={{ color: 'var(--textSecondary)' }}>
                of {totalWeeks} weeks
              </p>
            </div>

            <button
              onClick={() => setCurrentWeek(Math.min(totalWeeks, currentWeek + 1))}
              disabled={currentWeek === totalWeeks}
              className="px-4 py-2 rounded-lg font-bold border-2 transition-all duration-300 disabled:opacity-30"
              style={{
                borderColor: 'var(--borderColor)',
                color: 'var(--textPrimary)',
              }}
            >
              Next Week ‚Üí
            </button>
          </div>
        </div>

        {/* Weekly Schedule Preview */}
        {weeklyPlan?.schedule && (
          <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
            {weeklyPlan.schedule.map((day: any, index: number) => (
              <div
                key={index}
                className="themed-card p-6 border-2 cursor-pointer transition-all duration-300 hover:scale-105"
                style={{
                  backgroundColor: 'var(--bgCard)',
                  borderColor: 'var(--borderColor)',
                }}
              >
                <h3 
                  className="font-bold mb-2"
                  style={{ color: 'var(--accent1)' }}
                >
                  {day.day_label}
                </h3>
                <p className="text-sm" style={{ color: 'var(--textSecondary)' }}>
                  {day.workout?.length || 0} exercises
                </p>
                <p className="text-xs mt-2" style={{ color: 'var(--textSecondary)' }}>
                  {day.session_focus}
                </p>
              </div>
            ))}
          </div>
        )}

        {/* Detailed Workout View */}
        <div className="space-y-6">
          {weeklyPlan?.schedule?.map((day: any, dayIndex: number) => (
            <div
              key={dayIndex}
              className="themed-card p-8 border-2 space-y-6"
              style={{
                backgroundColor: 'var(--bgCard)',
                borderColor: 'var(--borderColor)',
              }}
            >
              {/* Day Header */}
              <div>
                <h2 
                  className="text-2xl font-bold mb-2"
                  style={{ color: 'var(--accent1)' }}
                >
                  {day.day_label}
                </h2>
                <p style={{ color: 'var(--textSecondary)' }}>
                  {day.session_focus}
                </p>
              </div>

              {/* Warmup */}
              {day.warmup && day.warmup.length > 0 && (
                <div>
                  <h3 
                    className="text-lg font-bold mb-2"
                    style={{ color: 'var(--accent2)' }}
                  >
                    Warmup
                  </h3>
                  <ul className="space-y-1">
                    {day.warmup.map((item: string, i: number) => (
                      <li key={i} style={{ color: 'var(--textSecondary)' }}>
                        ‚Ä¢ {item}
                      </li>
                    ))}
                  </ul>
                </div>
              )}

              {/* Exercises */}
              <div className="space-y-4">
                <h3 
                  className="text-lg font-bold"
                  style={{ color: 'var(--textPrimary)' }}
                >
                  Main Workout
                </h3>
                {day.workout?.map((exercise: any, exIndex: number) => (
                  <div
                    key={exIndex}
                    className="p-6 rounded-lg border-2"
                    style={{
                      backgroundColor: 'var(--bgSecondary)',
                      borderColor: 'var(--borderColor)',
                    }}
                  >
                    {/* Exercise Header */}
                    <div className="flex justify-between items-start mb-4">
                      <div>
                        <h4 
                          className="text-xl font-bold"
                          style={{ color: 'var(--textPrimary)' }}
                        >
                          {exIndex + 1}. {exercise.exercise}
                        </h4>
                        <p 
                          className="text-lg font-semibold mt-1"
                          style={{ color: 'var(--accent1)' }}
                        >
                          {exercise.sets} sets √ó {exercise.reps} reps
                        </p>
                      </div>
                    </div>

                    {/* Exercise Details */}
                    <div className="space-y-3">
                      {/* Why This Exercise */}
                      {exercise.why_this_exercise && (
                        <div>
                          <p 
                            className="text-sm font-semibold mb-1"
                            style={{ color: 'var(--accent2)' }}
                          >
                            üí° Why This Exercise:
                          </p>
                          <p 
                            className="text-sm"
                            style={{ color: 'var(--textSecondary)' }}
                          >
                            {exercise.why_this_exercise}
                          </p>
                        </div>
                      )}

                      {/* Form Cues */}
                      {exercise.form_cues && exercise.form_cues.length > 0 && (
                        <div>
                          <p 
                            className="text-sm font-semibold mb-1"
                            style={{ color: 'var(--accent3)' }}
                          >
                            ‚úÖ Form Cues:
                          </p>
                          <ul className="text-sm space-y-1">
                            {exercise.form_cues.map((cue: string, i: number) => (
                              <li 
                                key={i}
                                style={{ color: 'var(--textSecondary)' }}
                              >
                                ‚Ä¢ {cue}
                              </li>
                            ))}
                          </ul>
                        </div>
                      )}

                      {/* Tempo */}
                      {exercise.tempo && (
                        <div>
                          <p 
                            className="text-sm"
                            style={{ color: 'var(--textSecondary)' }}
                          >
                            ‚è±Ô∏è Tempo: {exercise.tempo} | Rest: {exercise.rest_seconds || 60}s
                          </p>
                        </div>
                      )}

                      {/* Substitutions */}
                      {exercise.substitutions && exercise.substitutions.length > 0 && (
                        <div>
                          <p 
                            className="text-sm font-semibold mb-1"
                            style={{ color: 'var(--textSecondary)' }}
                          >
                            üîÑ Alternatives:
                          </p>
                          <p 
                            className="text-sm"
                            style={{ color: 'var(--textSecondary)' }}
                          >
                            {exercise.substitutions.join(', ')}
                          </p>
                        </div>
                      )}
                    </div>
                  </div>
                ))}
              </div>

              {/* Cooldown */}
              {day.cooldown && day.cooldown.length > 0 && (
                <div>
                  <h3 
                    className="text-lg font-bold mb-2"
                    style={{ color: 'var(--accent2)' }}
                  >
                    Cooldown
                  </h3>
                  <ul className="space-y-1">
                    {day.cooldown.map((item: string, i: number) => (
                      <li key={i} style={{ color: 'var(--textSecondary)' }}>
                        ‚Ä¢ {item}
                      </li>
                    ))}
                  </ul>
                </div>
              )}

              {/* Optional Finisher */}
              {day.finisher_optional && day.finisher_optional.length > 0 && (
                <div>
                  <h3 
                    className="text-lg font-bold mb-2"
                    style={{ color: 'var(--accent4)' }}
                  >
                    Optional Finisher
                  </h3>
                  <ul className="space-y-1">
                    {day.finisher_optional.map((item: string, i: number) => (
                      <li key={i} style={{ color: 'var(--textSecondary)' }}>
                        ‚Ä¢ {item}
                      </li>
                    ))}
                  </ul>
                </div>
              )}
            </div>
          ))}
        </div>

        {/* Nutrition Summary */}
        {planData?.nutrition && (
          <div
            className="themed-card p-8 border-2"
            style={{
              backgroundColor: 'var(--bgCard)',
              borderColor: 'var(--borderColor)',
            }}
          >
            <h2 
              className="text-2xl font-bold mb-4"
              style={{ color: 'var(--accent1)' }}
            >
              Nutrition Targets
            </h2>
            <div className="grid md:grid-cols-3 gap-4">
              <div>
                <p 
                  className="text-sm"
                  style={{ color: 'var(--textSecondary)' }}
                >
                  Calories
                </p>
                <p 
                  className="text-2xl font-bold"
                  style={{ color: 'var(--textPrimary)' }}
                >
                  {planData.nutrition.calorie_target_range?.min || 0} - {planData.nutrition.calorie_target_range?.max || 0}
                </p>
              </div>
              <div>
                <p 
                  className="text-sm"
                  style={{ color: 'var(--textSecondary)' }}
                >
                  Protein
                </p>
                <p 
                  className="text-2xl font-bold"
                  style={{ color: 'var(--textPrimary)' }}
                >
                  {planData.nutrition.macros_grams?.protein || 0}g
                </p>
              </div>
              <div>
                <p 
                  className="text-sm"
                  style={{ color: 'var(--textSecondary)' }}
                >
                  Carbs / Fat
                </p>
                <p 
                  className="text-2xl font-bold"
                  style={{ color: 'var(--textPrimary)' }}
                >
                  {planData.nutrition.macros_grams?.carbs || 0}g / {planData.nutrition.macros_grams?.fat || 0}g
                </p>
              </div>
            </div>
          </div>
        )}

      </div>
    </div>
  )
}
</file>

<file path=".gitignore">
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
lerna-debug.log*

# Diagnostic reports (https://nodejs.org/api/report.html)
report.[0-9]*.[0-9]*.[0-9]*.[0-9]*.json

# Runtime data
pids
*.pid
*.seed
*.pid.lock

# Directory for instrumented libs generated by jscoverage/JSCover
lib-cov

# Coverage directory used by tools like istanbul
coverage
*.lcov

# nyc test coverage
.nyc_output

# Grunt intermediate storage (https://gruntjs.com/creating-plugins#storing-task-files)
.grunt

# Bower dependency directory (https://bower.io/)
bower_components

# node-waf configuration
.lock-wscript

# Compiled binary addons (https://nodejs.org/api/addons.html)
build/Release

# Dependency directories
node_modules/
jspm_packages/

# Snowpack dependency directory (https://snowpack.dev/)
web_modules/

# TypeScript cache
*.tsbuildinfo

# Optional npm cache directory
.npm

# Optional eslint cache
.eslintcache

# Optional stylelint cache
.stylelintcache

# Optional REPL history
.node_repl_history

# Output of 'npm pack'
*.tgz

# Yarn Integrity file
.yarn-integrity

# dotenv environment variable files
.env
.env.*
!.env.example

# parcel-bundler cache (https://parceljs.org/)
.cache
.parcel-cache

# Next.js build output
.next
out

# Nuxt.js build / generate output
.nuxt
dist

# Gatsby files
.cache/
# Comment in the public line in if your project uses Gatsby and not Next.js
# https://nextjs.org/blog/next-9-1#public-directory-support
# public

# vuepress build output
.vuepress/dist

# vuepress v2.x temp and cache directory
.temp
.cache

# Sveltekit cache directory
.svelte-kit/

# vitepress build output
**/.vitepress/dist

# vitepress cache directory
**/.vitepress/cache

# Docusaurus cache and generated files
.docusaurus

# Serverless directories
.serverless/

# FuseBox cache
.fusebox/

# DynamoDB Local files
.dynamodb/

# Firebase cache directory
.firebase/

# TernJS port file
.tern-port

# Stores VSCode versions used for testing VSCode extensions
.vscode-test

# yarn v3
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/sdks
!.yarn/versions

# Vite logs files
vite.config.js.timestamp-*
vite.config.ts.timestamp-*
</file>

<file path="app/api/generate-plan/route.ts">
import { NextRequest, NextResponse } from 'next/server'
import Anthropic from '@anthropic-ai/sdk'

// Initialize Anthropic client
const anthropic = new Anthropic({
  apiKey: process.env.ANTHROPIC_API_KEY!,
})

export async function POST(request: NextRequest) {
  try {
    // Get user data from request body
    const body = await request.json()
    const { profile, currentPhotos, goalPhotos } = body

    if (!profile) {
      return NextResponse.json(
        { error: 'Profile data is required' },
        { status: 400 }
      )
    }

    // Build the enhanced AI prompt
    console.log('Building prompt for user:', profile.full_name)
    const prompt = buildEnhancedPrompt(profile, currentPhotos, goalPhotos)
    console.log('Prompt length:', prompt.length, 'characters')

    // Call Claude API
    console.log('Calling Claude API...')
    const message = await anthropic.messages.create({
      model: 'claude-sonnet-4-20250514',
      max_tokens: 16000,
      temperature: 0.7,
      messages: [
        {
          role: 'user',
          content: prompt,
        },
      ],
    })
    console.log('‚úÖ Claude API responded')

    // Extract the JSON response
    console.log('Raw AI message:', message)
    
    const responseText = message.content[0]?.type === 'text' 
      ? message.content[0].text 
      : ''

    console.log('Response text length:', responseText.length)
    console.log('First 500 chars:', responseText.substring(0, 500))

    if (!responseText || responseText.length === 0) {
      console.error('Empty response from AI')
      return NextResponse.json(
        { error: 'AI returned empty response', details: 'No content in message' },
        { status: 500 }
      )
    }

    // Parse the JSON (Claude should return pure JSON)
    let planData
    try {
      // Remove markdown code blocks if present
      let cleanedResponse = responseText
        .replace(/```json\n?/gi, '')
        .replace(/```\n?/g, '')
        .trim()
      
      // Remove any leading/trailing text before/after JSON
      const jsonStart = cleanedResponse.indexOf('{')
      const jsonEnd = cleanedResponse.lastIndexOf('}')
      
      if (jsonStart === -1 || jsonEnd === -1) {
        throw new Error('No JSON object found in response')
      }
      
      cleanedResponse = cleanedResponse.substring(jsonStart, jsonEnd + 1)
      
      console.log('Cleaned response length:', cleanedResponse.length)
      console.log('Attempting to parse JSON...')
      
      planData = JSON.parse(cleanedResponse)
      console.log('‚úÖ JSON parsed successfully')
    } catch (parseError: any) {
      console.error('Failed to parse AI response')
      console.error('Parse error:', parseError.message)
      console.error('Full response:', responseText)
      return NextResponse.json(
        { 
          error: 'Failed to parse AI response', 
          details: parseError.message,
          responsePreview: responseText.substring(0, 1000)
        },
        { status: 500 }
      )
    }

    return NextResponse.json({
      success: true,
      plan: planData,
    })

  } catch (error: any) {
    console.error('AI generation error:', error)
    return NextResponse.json(
      { error: 'Failed to generate plan', details: error.message },
      { status: 500 }
    )
  }
}

function buildEnhancedPrompt(
  profile: any,
  currentPhotos: any[] = [],
  goalPhotos: any[] = []
): string {
  const hasPhotos = currentPhotos.length > 0 || goalPhotos.length > 0
  
  // Calculate BMR using Mifflin-St Jeor equation
  const heightCm = profile.height_cm || 178
  const weightKg = profile.weight_unit === 'kg' 
    ? profile.current_weight 
    : profile.current_weight * 0.453592
  const age = profile.age
  const isMale = profile.gender === 'Male'
  
  let bmr
  if (isMale) {
    bmr = Math.round((10 * weightKg) + (6.25 * heightCm) - (5 * age) + 5)
  } else {
    bmr = Math.round((10 * weightKg) + (6.25 * heightCm) - (5 * age) - 161)
  }
  
  // Calculate TDEE (BMR * activity multiplier)
  const activityMultiplier = 1.55 // Moderate activity (3-5 workouts/week)
  const tdee = Math.round(bmr * activityMultiplier)
  
  // Equipment context
  let equipmentContext = ''
  if (profile.training_location === 'commercial') {
    equipmentContext = `Training at a commercial gym (${profile.gym_chain || profile.gym_custom_name || 'unnamed gym'}). Assume access to standard gym equipment: barbells, dumbbells, cable machines, benches, smith machine, leg press, squat racks, etc. Avoid exotic or specialty machines that aren't universally available.`
  } else {
    const equipment = profile.available_equipment || []
    if (equipment.length === 0 || equipment.includes('No Equipment')) {
      equipmentContext = `Training location: ${profile.training_location}. NO EQUIPMENT AVAILABLE (bodyweight only). CRITICAL: ONLY prescribe bodyweight exercises. Do not suggest ANY equipment-based exercises.`
    } else {
      equipmentContext = `Training location: ${profile.training_location}. Available equipment: ${equipment.join(', ')}. CRITICAL: ONLY prescribe exercises using EXACTLY this equipment. Do not suggest equipment they don't have. If they don't have barbells, use dumbbells. If they don't have cables, use bands or bodyweight alternatives.`
    }
  }

  // Parse workout frequency
  const frequencyMap: Record<string, number> = {
    '1-2 days per week': 2,
    '3-4 days per week': 4,
    '5-6 days per week': 5,
    'Every day': 6
  }
  const daysPerWeek = frequencyMap[profile.workout_frequency] || 4

  return `You are an expert fitness coach creating a personalized training plan for Apex Fitness Coach.

CRITICAL RULES:
- No medical advice, diagnoses, or clinical guidance
- Do NOT estimate body fat %, weight, or health metrics from photos
- Use fitness-coach language: focus on visible development, proportions, definition, training priorities
- Output STRICT JSON ONLY (no markdown, no explanations outside JSON)
- If any input is missing, make conservative assumptions and list them in assumptions[]

=== USER PROFILE ===

VITALS & DEMOGRAPHICS:
- Name: ${profile.full_name}
- Age: ${profile.age}
- Gender: ${profile.gender}
- Height: ${profile.height_feet}'${profile.height_inches || 0}" (${heightCm}cm)
- Current Weight: ${profile.current_weight} ${profile.weight_unit} (${weightKg.toFixed(1)} kg)
${profile.goal_weight ? `- Goal Weight: ${profile.goal_weight} ${profile.weight_unit} (change needed: ${Math.abs(profile.goal_weight - profile.current_weight).toFixed(1)} ${profile.weight_unit})` : '- Goal: Body composition focus (not scale weight - user wants to look better, not chase a number)'}

METABOLIC DATA (calculated):
- BMR (Basal Metabolic Rate): ~${bmr} calories/day
- TDEE (Total Daily Energy Expenditure): ~${tdee} calories/day
- Activity Level: Moderate (${daysPerWeek} training days per week)

TRAINING PROFILE:
- Stated Fitness Goal: ${profile.fitness_goal}
- Experience Level: ${profile.experience_level}
- ${equipmentContext}
- Workout Frequency: ${profile.workout_frequency} (${daysPerWeek} days per week)

=== VISUAL ANALYSIS ${hasPhotos ? 'REQUIRED' : '(NO PHOTOS PROVIDED)'} ===

${hasPhotos ? `
PHOTOS PROVIDED: YES (${currentPhotos.length} current, ${goalPhotos.length} goal)

STEP 1: ANALYZE CURRENT PHYSIQUE
Based on visible indicators in the current photo(s), assess:

A) MUSCLE DEVELOPMENT (visual, descriptive only - NO percentages):
   - Upper Body: Shoulder width/roundness, chest thickness/definition, arm development, back width
   - Core: Visible ab development, oblique definition, overall torso structure
   - Lower Body: Leg development, glute development, proportions
   - Overall Symmetry: Balanced vs imbalanced development

B) BODY COMPOSITION (descriptive only - NO measurements):
   - Visible leanness level (use terms like "lean", "moderate leanness", "higher body fat")
   - Fat distribution (where fat is held - waist, hips, etc.)
   - Muscle definition visibility (where muscles are visible vs covered)

C) STRUCTURAL OBSERVATIONS:
   - Posture indicators
   - Natural body structure (frame size, limb lengths)
   - Proportions

D) STRENGTHS TO LEVERAGE (positive focus):
   - What already looks good
   - Areas with solid foundation
   - Natural advantages

STEP 2: ANALYZE GOAL PHYSIQUE
${goalPhotos.length > 0 ? `
Based on the goal photo(s):
${goalPhotos[0]?.description ? `- User's description: "${goalPhotos[0].description}"` : ''}
${goalPhotos[0]?.goal_person_name ? `- Reference: ${goalPhotos[0].goal_person_name}` : ''}
${goalPhotos[0]?.goal_person_height ? `- Reference height: ${goalPhotos[0].goal_person_height}` : ''}
${goalPhotos[0]?.goal_person_weight ? `- Reference weight: ${goalPhotos[0].goal_person_weight}` : ''}

Assess target aesthetics:
- TARGET MUSCLE DEVELOPMENT: What muscles are prominently developed
- TARGET LEANNESS: Relative body composition
- TARGET PROPORTIONS: Key aesthetic features (V-taper, X-frame, athletic build)
- TARGET DEFINITION: Specific features (abs, V-cut, shoulder definition, chest separation)
` : 'No goal photos provided - infer from fitness goal and experience level.'}

STEP 3: GAP ANALYSIS (CRITICAL FOR EXERCISE SELECTION)
Compare current vs goal:

A) MUSCLES TO BUILD (prioritized list):
   - Which muscle groups need development
   - Priority: HIGH/MEDIUM/LOW
   - Expected timeline for visible changes
   
B) DEFINITION TO REVEAL:
   - Areas where muscle exists but is covered
   - What will emerge as body fat reduces
   
C) PROPORTIONS TO BALANCE:
   - Any asymmetries to address
   - What needs emphasis to achieve goal proportions

D) EXERCISE SELECTION RATIONALE:
   For each major muscle group, explain:
   - Current state
   - Goal state
   - WHY specific exercises bridge that gap
   - Expected progression timeline

STEP 4: PERSONALIZED MOTIVATION
Create a motivational paragraph that:
- Acknowledges current strengths
- Explains specific focus areas
- Sets realistic expectations with timelines
- Sounds encouraging but honest

Example tone: "You have great shoulder width to build on - we'll focus on adding chest thickness, especially in the lower pecs, while progressively reducing body fat. Your abs will start showing around week 10-14 as we combine targeted core work with our calorie deficit."

` : `
PHOTOS PROVIDED: NO

Without photos, generate plan based on:
- Profile data (goal, experience, equipment, vitals)
- General principles for the stated goal
- Conservative assumptions

Note in assumptions[]:
- Visual analysis would significantly improve specificity
- Timeline estimates are conservative without visual data
- Exercise selection is based on goal type, not individual physique analysis
`}

=== REQUIRED JSON OUTPUT ===

Generate a complete plan with this EXACT structure:

{
  "assumptions": [
    "List any assumptions made due to missing data",
    ${!hasPhotos ? '"No photos provided - using general approach for goal type",' : ''}
    "Any equipment or experience assumptions"
  ],
  
  "disclaimer": "This plan is for educational purposes only. Consult healthcare professionals before starting any fitness program. Individual results vary based on consistency, nutrition adherence, genetics, and other factors.",
  
  ${hasPhotos ? `
  "current_state_assessment": {
    "strengths": [
      "Specific positive attributes visible in photos",
      "Areas with good development",
      "Natural advantages"
    ],
    "areas_to_develop": [
      "Specific muscles/areas needing work",
      "Body composition goals",
      "Proportional targets"
    ]
  },
  
  "visual_gap_summary": {
    "personalized_motivation": "3-5 sentence paragraph acknowledging strengths and explaining focus areas with timeline mentions",
    
    "priority_focus_areas": [
      {
        "area": "Muscle group or aesthetic feature",
        "current_state": "Visual assessment",
        "target_state": "Desired outcome",
        "why": "Why this matters for achieving goal physique",
        "priority": "high|medium|low",
        "timeline_weeks": number,
        "training_approach": "How we'll address this"
      }
    ]
  },
  ` : ''}
  
  "inputs_used": {
    "has_photos": ${hasPhotos},
    "height_cm": ${heightCm},
    "weight_kg": ${weightKg.toFixed(1)},
    "bmr": ${bmr},
    "tdee": ${tdee},
    "goal_weight": ${profile.goal_weight ? `"${profile.goal_weight} ${profile.weight_unit}"` : '"Body composition focus"'},
    "training_location": "${profile.training_location}",
    "equipment": ${JSON.stringify(profile.available_equipment || [])},
    "days_per_week": ${daysPerWeek}
  },
  
  "time_to_goal": {
    "estimate_weeks_range": { 
      "min": number, 
      "max": number 
    },
    "rationale": "Explanation based on current weight, goal, expected rate of change (0.5-2 lbs muscle/month or 0.5-2 lbs fat/week), age, experience level",
    "confidence": "low|medium|high"
  },
  
  "milestones": [
    {
      "week_range": { "start": 1, "end": 4 },
      "title": "Foundation Phase",
      "expected_changes": [
        "Improved form and technique",
        "Initial strength gains",
        "Routine establishment"
      ],
      "visual_changes": [
        "Pump becomes noticeable",
        "Slight muscle hardness increase",
        "Clothes may fit differently"
      ],
      "focus": ["Form mastery", "Building consistency"]
    }
  ],
  
  "weekly_plan": {
    "program_length_weeks": number,
    "days_per_week": ${daysPerWeek},
    "split_name": "Upper/Lower" | "Push/Pull/Legs" | "Full Body" | "Bro Split",
    "split_rationale": "WHY this split for THIS user based on days available, experience, and goals",
    
    "schedule": [
      {
        "day_label": "Day 1: [Muscle Focus]",
        "session_focus": "Brief description",
        "target_muscle_groups": ["Chest", "Triceps", "Shoulders"],
        ${hasPhotos ? '"why_this_session": "How this addresses gaps identified in visual analysis",' : ''}
        
        "warmup": [
          "5 min light cardio",
          "Dynamic stretches",
          "Mobility work"
        ],
        
        "workout": [
          {
            "exercise": "Exercise name",
            "sets": number,
            "reps": "8-10" | "12-15" | "AMRAP",
            "rest_seconds": 60-120,
            "tempo": "2-0-1-0 (eccentric-pause-concentric-pause)",
            "notes": "Execution tips",
            ${hasPhotos ? '"why_this_exercise": "CRITICAL - Explain how this addresses specific gap from visual analysis",' : '"why_this_exercise": "How this supports the stated fitness goal",'}
            "form_cues": [
              "Key technique point 1",
              "Key technique point 2"
            ],
            "substitutions": [
              "Alternative if equipment unavailable"
            ]
          }
        ],
        
        "cooldown": [
          "Static stretches for worked muscles",
          "5 min light cardio",
          "Foam rolling"
        ]
      }
    ],
    
    "progression_rules": [
      "If completing all reps with good form, increase weight by 2.5-5 lbs",
      "Track all workouts for progressive overload",
      "Deload every 4-6 weeks (reduce weight 40%, maintain frequency)"
    ],
    
    "cardio_and_conditioning": {
      "sessions_per_week": 2-4,
      "type": ["LISS", "HIIT"],
      "duration_minutes_each": 20-30,
      "why_this_cardio": "Based on ${profile.fitness_goal} - explanation",
      "timing_recommendation": "Separate from weights by 6+ hours or after weights"
    }
  },
  
  "recovery_and_steps": {
    "steps_target_range": { "min": number, "max": number },
    "why_these_steps": "Based on ${profile.fitness_goal} and activity level",
    "sleep_target_hours_range": { "min": 7, "max": 9 },
    "sleep_priority": "Sleep is when growth happens - aim for ${age < 25 ? '8-9' : '7-8'} hours"
  },
  
  "nutrition": {
    "goal": "${profile.fitness_goal}",
    
    "calorie_target_range": {
      "min": number,
      "max": number
    },
    
    "calorie_rationale": "Based on BMR ${bmr}, TDEE ${tdee}. ${profile.fitness_goal.includes('Lose') ? 'Deficit of 15-20% for fat loss' : profile.fitness_goal.includes('Build') ? 'Surplus of 10-15% for muscle gain' : 'Maintenance for recomposition'}",
    
    "macros_grams": {
      "protein": number,
      "carbs": number,
      "fat": number
    },
    
    "macro_rationale": "Protein: ~1g per lb bodyweight. Carbs: ${profile.fitness_goal.includes('Build') ? 'Higher for fuel' : 'Moderate for energy'}. Fats: Adequate for hormones.",
    
    "example_day": {
      "breakfast": ["Item 1", "Item 2"],
      "lunch": ["Item 1", "Item 2"],
      "dinner": ["Item 1", "Item 2"],
      "snacks": ["Item 1", "Item 2"]
    }
  }
}

CRITICAL REMINDERS:
1. Output ONLY valid JSON (no markdown, no commentary)
2. ${hasPhotos ? 'Every exercise MUST have "why_this_exercise" connecting to visual gap analysis' : 'Explain why each exercise supports the stated goal'}
3. Use ONLY the equipment available (or bodyweight if none)
4. Generate for EXACTLY ${daysPerWeek} days per week
5. Be realistic with timelines based on vitals and experience
6. ${hasPhotos ? 'Personalized motivation must reference specific visual observations' : 'Keep general but motivating'}

Generate the complete plan now.`
}
</file>

<file path="app/api/initialize-stats/route.ts">
import { NextRequest, NextResponse } from 'next/server'
import { createClient } from '@supabase/supabase-js'

// Calculate XP required for next level (RPG-style exponential curve)
function getXPForLevel(level: number): number {
  return Math.floor(100 * Math.pow(level, 1.5))
}

// Calculate current level based on total XP
function getLevelFromXP(totalXP: number): number {
  let level = 1
  let xpNeeded = 0
  
  while (xpNeeded <= totalXP) {
    level++
    xpNeeded += getXPForLevel(level - 1)
  }
  
  return level - 1
}

export async function POST(request: NextRequest) {
  try {
    // Get auth token
    const authHeader = request.headers.get('authorization')
    
    if (!authHeader || !authHeader.startsWith('Bearer ')) {
      return NextResponse.json(
        { error: 'Unauthorized' },
        { status: 401 }
      )
    }

    const accessToken = authHeader.replace('Bearer ', '')

    // Create Supabase client
    const supabase = createClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
      {
        global: {
          headers: {
            Authorization: `Bearer ${accessToken}`
          }
        }
      }
    )

    // Get user
    const { data: { user }, error: authError } = await supabase.auth.getUser(accessToken)

    if (authError || !user) {
      return NextResponse.json(
        { error: 'Unauthorized' },
        { status: 401 }
      )
    }

    // Check if user_stats already exists
    const { data: existingStats } = await supabase
      .from('user_stats')
      .select('*')
      .eq('user_id', user.id)
      .single()

    if (existingStats) {
      return NextResponse.json({
        message: 'Stats already initialized',
        stats: existingStats
      })
    }

    // Get active plan to determine plan start date
    const { data: activePlan } = await supabase
      .from('user_plans')
      .select('created_at')
      .eq('user_id', user.id)
      .eq('status', 'active')
      .single()

    const planStartDate = activePlan?.created_at 
      ? new Date(activePlan.created_at).toISOString().split('T')[0]
      : new Date().toISOString().split('T')[0]

    // Initialize user_stats
    const startingXP = 100 // Starting XP for creating account
    const startingLevel = getLevelFromXP(startingXP)
    
    const { data: stats, error: statsError } = await supabase
      .from('user_stats')
      .insert({
        user_id: user.id,
        plan_start_date: planStartDate,
        current_week: 1,
        total_workouts_completed: 0,
        total_workouts_planned: 0,
        current_streak_days: 0,
        longest_streak_days: 0,
        total_xp: startingXP,
        level: startingLevel,
        total_badges_earned: 0,
        current_x_percent: 0,
        best_x_percent: 0,
        average_x_percent: 0
      })
      .select()
      .single()

    if (statsError) {
      console.error('Error creating stats:', statsError)
      return NextResponse.json(
        { error: 'Failed to initialize stats', details: statsError.message },
        { status: 500 }
      )
    }

    // Award "Journey Begins" badge
    const badgeXP = 100
    const { data: firstBadge, error: badgeError } = await supabase
      .from('user_badges')
      .insert({
        user_id: user.id,
        badge_key: 'journey_begins',
        badge_name: 'Journey Begins',
        badge_description: 'Generated your first AI-powered fitness plan',
        badge_tier: 'bronze',
        theme_exclusive: null, // Universal badge
        xp_earned: badgeXP,
        progress_current: 1,
        progress_required: 1
      })
      .select()
      .single()

    // Update total XP and level with badge XP
    if (!badgeError) {
      const newTotalXP = startingXP + badgeXP
      const newLevel = getLevelFromXP(newTotalXP)
      
      await supabase
        .from('user_stats')
        .update({ 
          total_badges_earned: 1,
          total_xp: newTotalXP,
          level: newLevel
        })
        .eq('user_id', user.id)
    }

    // Initialize Week 1 progress
    const today = new Date()
    const weekStart = new Date(planStartDate)
    const weekEnd = new Date(weekStart)
    weekEnd.setDate(weekEnd.getDate() + 6)

    const { data: weekProgress, error: progressError } = await supabase
      .from('user_progress')
      .insert({
        user_id: user.id,
        week_number: 1,
        week_start_date: weekStart.toISOString().split('T')[0],
        week_end_date: weekEnd.toISOString().split('T')[0],
        workouts_planned: 4, // Default from plan
        workouts_completed: 0,
        current_streak_days: 0,
        step_goal_days_hit: 0,
        step_goal_days_total: 7,
        x_percent_better: 0
      })
      .select()
      .single()

    return NextResponse.json({
      success: true,
      stats,
      firstBadge,
      weekProgress,
      xpSystem: {
        currentLevel: stats.level,
        totalXP: stats.total_xp,
        xpForNextLevel: getXPForLevel(stats.level),
        xpProgress: stats.total_xp % getXPForLevel(stats.level)
      },
      message: 'Stats initialized! You earned your first badge! üéâ'
    })

  } catch (error: any) {
    console.error('Initialization error:', error)
    return NextResponse.json(
      { error: 'Failed to initialize', details: error.message },
      { status: 500 }
    )
  }
}
</file>

<file path="app/api/test-auth/route.ts">
import { NextRequest, NextResponse } from 'next/server'
import { createClient } from '@supabase/supabase-js'

export async function GET(request: NextRequest) {
  try {
    // Get all cookies
    const cookieStore = request.cookies
    const allCookies = cookieStore.getAll()
    
    console.log('=== AUTH DEBUG ===')
    console.log('Total cookies:', allCookies.length)
    console.log('Cookie names:', allCookies.map(c => c.name))
    
    // Try to find any Supabase cookies
    const supabaseCookies = allCookies.filter(c => 
      c.name.includes('supabase') || 
      c.name.includes('sb-') ||
      c.name.includes('auth')
    )
    
    console.log('Supabase-related cookies:', supabaseCookies.map(c => c.name))
    
    // Create Supabase client
    const supabase = createClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
    )
    
    // Try multiple ways to get the user
    let user = null
    let method = 'none'
    
    // Method 1: Try each cookie
    for (const cookie of supabaseCookies) {
      try {
        const { data, error } = await supabase.auth.getUser(cookie.value)
        if (data?.user && !error) {
          user = data.user
          method = `cookie: ${cookie.name}`
          break
        }
      } catch (e) {
        // Continue to next cookie
      }
    }
    
    // Method 2: Try without token (session from cookies)
    if (!user) {
      try {
        const { data, error } = await supabase.auth.getUser()
        if (data?.user && !error) {
          user = data.user
          method = 'getUser() without token'
        }
      } catch (e) {
        // Failed
      }
    }
    
    return NextResponse.json({
      success: !!user,
      method: method,
      user: user ? {
        id: user.id,
        email: user.email
      } : null,
      cookies: allCookies.map(c => ({
        name: c.name,
        hasValue: !!c.value,
        valueLength: c.value.length
      })),
      supabaseCookies: supabaseCookies.map(c => c.name)
    })
    
  } catch (error: any) {
    console.error('Test error:', error)
    return NextResponse.json({
      error: error.message,
      stack: error.stack
    }, { status: 500 })
  }
}
</file>

<file path="app/dashboard/page.tsx.backup">
'use client'

import { useEffect, useState } from 'react'
import { useRouter } from 'next/navigation'
import Link from 'next/link'
import { useAuth } from '@/components/AuthProvider'
import { useTheme } from '@/components/ThemeProvider'
import { ThemeSwitcher } from '@/components/ThemeSwitcher'
import { supabaseBrowser } from '@/lib/supabaseClient'

interface UserProfile {
  id: string
  user_id: string
  full_name: string
  age: number
  gender: string
  fitness_goal: string
  experience_level: string
  available_equipment: string[]
  workout_frequency: string
  has_completed_onboarding: boolean
  created_at: string
}

export default function DashboardPage() {
  const { user, loading: authLoading, signOut } = useAuth()
  const { themeConfig } = useTheme()
  const router = useRouter()
  
  const [profile, setProfile] = useState<UserProfile | null>(null)
  const [profileLoading, setProfileLoading] = useState(true)
  const [profileError, setProfileError] = useState<string | null>(null)

  useEffect(() => {
    if (!authLoading && !user) {
      router.push('/login')
    }
  }, [user, authLoading, router])

  useEffect(() => {
    const fetchProfile = async () => {
      if (!user) return

      try {
        setProfileLoading(true)
        setProfileError(null)

        const { data, error } = await supabaseBrowser
          .from('user_profiles')
          .select('*')
          .eq('user_id', user.id)
          .single()

        if (error) {
          if (error.code === 'PGRST116') {
            setProfile(null)
          } else {
            throw error
          }
        } else {
          setProfile(data)
        }
      } catch (err: any) {
        console.error('Error fetching profile:', err)
        setProfileError(err.message || 'Failed to load profile')
      } finally {
        setProfileLoading(false)
      }
    }

    if (user) {
      fetchProfile()
    }
  }, [user])

  if (authLoading || profileLoading) {
    return (
      <div 
        className="min-h-screen flex items-center justify-center"
        style={{ background: 'var(--bgPrimary)' }}
      >
        <div className="text-center space-y-4">
          <div 
            className="text-2xl font-bold"
            style={{ color: 'var(--textPrimary)' }}
          >
            Loading your dashboard...
          </div>
          <div 
            className="w-12 h-12 border-4 border-t-transparent rounded-full animate-spin mx-auto"
            style={{ borderColor: 'var(--accent1)', borderTopColor: 'transparent' }}
          />
        </div>
      </div>
    )
  }

  if (!user) {
    return null
  }

  if (profileError) {
    return (
      <div 
        className="min-h-screen p-8 transition-all duration-500"
        style={{ background: 'var(--bgPrimary)' }}
      >
        <div className="max-w-6xl mx-auto">
          <div
            className="themed-card p-8 border-2"
            style={{
              backgroundColor: 'var(--bgCard)',
              borderColor: '#EF4444',
            }}
          >
            <h2 
              className="text-2xl font-bold mb-4"
              style={{ color: '#EF4444' }}
            >
              Error Loading Profile
            </h2>
            <p style={{ color: 'var(--textSecondary)' }}>
              {profileError}
            </p>
            <button
              onClick={() => window.location.reload()}
              className="mt-4 px-6 py-3 rounded-lg font-bold transition-all duration-300 hover:opacity-80"
              style={{
                background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                color: '#FFFFFF',
              }}
            >
              Try Again
            </button>
          </div>
        </div>
      </div>
    )
  }

  return (
    <div 
      className="min-h-screen p-8 transition-all duration-500"
      style={{ background: 'var(--bgPrimary)' }}
    >
      <div className="max-w-6xl mx-auto space-y-8">
        
        <div className="flex justify-between items-start flex-wrap gap-4">
          <div>
            <h1 
              className="text-4xl font-bold mb-2"
              style={{
                background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                backgroundClip: 'text',
              }}
            >
              {profile ? `Welcome back, ${profile.full_name}!` : 'Welcome to Apex Fitness Coach'}
            </h1>
            <p style={{ color: 'var(--textSecondary)' }}>
              {user.email}
            </p>
          </div>

          <button
            onClick={signOut}
            className="px-6 py-3 rounded-lg font-bold transition-all duration-300 hover:opacity-80"
            style={{
              background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
              color: '#FFFFFF',
            }}
          >
            Sign Out
          </button>
        </div>

        {!profile && (
          <div
            className="themed-card p-8 border-2 text-center"
            style={{
              backgroundColor: 'var(--bgCard)',
              borderColor: 'var(--borderColor)',
            }}
          >
            <div className="space-y-6">
              <div>
                <div 
                  className="text-6xl mb-4"
                  style={{ color: 'var(--accent1)' }}
                >
                  üëã
                </div>
                <h2 
                  className="text-3xl font-bold mb-2"
                  style={{ color: 'var(--textPrimary)' }}
                >
                  Let's Get You Started!
                </h2>
                <p 
                  className="text-lg"
                  style={{ color: 'var(--textSecondary)' }}
                >
                  Complete your profile so we can build your personalized fitness plan
                </p>
              </div>

              <Link href="/onboarding">
                <button
                  className="px-8 py-4 rounded-lg font-bold text-lg transition-all duration-300 hover:scale-105"
                  style={{
                    background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                    color: '#FFFFFF',
                  }}
                >
                  Complete Your Profile ‚Üí
                </button>
              </Link>

              <div className="pt-6 border-t" style={{ borderColor: 'var(--borderColor)' }}>
                <p 
                  className="text-sm"
                  style={{ color: 'var(--textSecondary)' }}
                >
                  Takes less than 2 minutes ‚Ä¢ 4 simple questions
                </p>
              </div>
            </div>
          </div>
        )}

        {profile && (
          <>
            <div
              className="themed-card p-8 border-2"
              style={{
                backgroundColor: 'var(--bgCard)',
                borderColor: 'var(--borderColor)',
              }}
            >
              <div className="flex justify-between items-start mb-6">
                <h2 
                  className="text-2xl font-bold"
                  style={{ color: 'var(--accent1)' }}
                >
                  Your Profile
                </h2>
                <button
                  className="px-4 py-2 rounded-lg font-semibold text-sm border-2 transition-all duration-300 hover:opacity-80"
                  style={{
                    borderColor: 'var(--accent1)',
                    color: 'var(--accent1)',
                  }}
                >
                  Edit Profile
                </button>
              </div>

              <div className="grid md:grid-cols-2 gap-6">
                <div className="space-y-4">
                  <div>
                    <p 
                      className="text-sm font-semibold mb-1"
                      style={{ color: 'var(--textSecondary)' }}
                    >
                      Age
                    </p>
                    <p 
                      className="text-lg font-bold"
                      style={{ color: 'var(--textPrimary)' }}
                    >
                      {profile.age} years old
                    </p>
                  </div>

                  <div>
                    <p 
                      className="text-sm font-semibold mb-1"
                      style={{ color: 'var(--textSecondary)' }}
                    >
                      Gender
                    </p>
                    <p 
                      className="text-lg font-bold"
                      style={{ color: 'var(--textPrimary)' }}
                    >
                      {profile.gender}
                    </p>
                  </div>

                  <div>
                    <p 
                      className="text-sm font-semibold mb-1"
                      style={{ color: 'var(--textSecondary)' }}
                    >
                      Experience Level
                    </p>
                    <p 
                      className="text-lg font-bold"
                      style={{ color: 'var(--textPrimary)' }}
                    >
                      {profile.experience_level}
                    </p>
                  </div>
                </div>

                <div className="space-y-4">
                  <div>
                    <p 
                      className="text-sm font-semibold mb-1"
                      style={{ color: 'var(--textSecondary)' }}
                    >
                      Primary Goal
                    </p>
                    <p 
                      className="text-lg font-bold"
                      style={{ color: 'var(--textPrimary)' }}
                    >
                      {profile.fitness_goal}
                    </p>
                  </div>

                  <div>
                    <p 
                      className="text-sm font-semibold mb-1"
                      style={{ color: 'var(--textSecondary)' }}
                    >
                      Training Frequency
                    </p>
                    <p 
                      className="text-lg font-bold"
                      style={{ color: 'var(--textPrimary)' }}
                    >
                      {profile.workout_frequency}
                    </p>
                  </div>

                  <div>
                    <p 
                      className="text-sm font-semibold mb-1"
                      style={{ color: 'var(--textSecondary)' }}
                    >
                      Available Equipment
                    </p>
                    <div className="flex flex-wrap gap-2 mt-2">
                      {profile.available_equipment.map((equipment) => (
                        <span
                          key={equipment}
                          className="px-3 py-1 rounded-full text-sm font-semibold"
                          style={{
                            backgroundColor: 'var(--bgSecondary)',
                            color: 'var(--accent2)',
                          }}
                        >
                          {equipment}
                        </span>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div
              className="themed-card p-8 border-2"
              style={{
                backgroundColor: 'var(--bgCard)',
                borderColor: 'var(--borderColor)',
              }}
            >
              <h3 
                className="text-xl font-bold mb-4"
                style={{ color: 'var(--accent2)' }}
              >
                üöÄ What's Next?
              </h3>
              <div className="space-y-3" style={{ color: 'var(--textSecondary)' }}>
                <p>‚úÖ Profile complete!</p>
                <p>üì∏ Next: Upload your current and goal physique photos</p>
                <p>ü§ñ Then: AI will generate your personalized plan</p>
                <p>üí™ After that: Start crushing your workouts!</p>
              </div>
              
              <div className="mt-6 pt-6 border-t" style={{ borderColor: 'var(--borderColor)' }}>
                <p 
                  className="text-sm font-semibold mb-3"
                  style={{ color: 'var(--textPrimary)' }}
                >
                  Current Phase Status:
                </p>
                <p 
                  className="text-sm"
                  style={{ color: 'var(--textSecondary)' }}
                >
                  Phase 2 Day 2 Complete: Profile data is now displayed on your dashboard!
                </p>
              </div>
            </div>
          </>
        )}

        <div className="space-y-4">
          <h2 
            className="text-2xl font-bold"
            style={{ color: 'var(--textPrimary)' }}
          >
            Choose Your Theme
          </h2>
          <ThemeSwitcher />
        </div>

      </div>
    </div>
  )
}
</file>

<file path="app/login/page.tsx">
'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'
import Link from 'next/link'
import { supabaseBrowser } from '@/lib/supabaseClient'
import { useTheme } from '@/components/ThemeProvider'

export default function LoginPage() {
  const router = useRouter()
  const { themeConfig } = useTheme()
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState<string | null>(null)

  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError(null)

    try {
      const { data, error } = await supabaseBrowser.auth.signInWithPassword({
        email,
        password,
      })

      if (error) throw error

      // Successful login - redirect to dashboard
      router.push('/dashboard')
    } catch (err: any) {
      setError(err.message || 'Login failed')
    } finally {
      setLoading(false)
    }
  }

  return (
    <div 
      className="min-h-screen flex items-center justify-center p-8 transition-all duration-500"
      style={{ background: `var(--bgPrimary)` }}
    >
      <div className="w-full max-w-md space-y-8">
        
        {/* Header */}
        <div className="text-center space-y-2">
          <h1 
            className="text-4xl font-bold"
            style={{
              background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              backgroundClip: 'text',
            }}
          >
            Welcome Back
          </h1>
          <p style={{ color: 'var(--textSecondary)' }}>
            Sign in to continue your fitness journey
          </p>
        </div>

        {/* Login Card */}
        <div
          className="themed-card p-8 border-2 space-y-6"
          style={{
            backgroundColor: 'var(--bgCard)',
            borderColor: 'var(--borderColor)',
          }}
        >
          <form onSubmit={handleLogin} className="space-y-6">
            
            {/* Email Input */}
            <div className="space-y-2">
              <label 
                htmlFor="email" 
                className="block text-sm font-semibold"
                style={{ color: 'var(--textPrimary)' }}
              >
                Email
              </label>
              <input
                id="email"
                type="email"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                required
                className="w-full px-4 py-3 rounded-lg border-2 transition-all duration-300 focus:outline-none focus:ring-2"
                style={{
                  backgroundColor: 'var(--bgSecondary)',
                  borderColor: 'var(--borderColor)',
                  color: 'var(--textPrimary)',
                }}
                placeholder="your@email.com"
              />
            </div>

            {/* Password Input */}
            <div className="space-y-2">
              <label 
                htmlFor="password" 
                className="block text-sm font-semibold"
                style={{ color: 'var(--textPrimary)' }}
              >
                Password
              </label>
              <input
                id="password"
                type="password"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                required
                className="w-full px-4 py-3 rounded-lg border-2 transition-all duration-300 focus:outline-none focus:ring-2"
                style={{
                  backgroundColor: 'var(--bgSecondary)',
                  borderColor: 'var(--borderColor)',
                  color: 'var(--textPrimary)',
                }}
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
              />
            </div>

            {/* Error Message */}
            {error && (
              <div 
                className="p-4 rounded-lg border-2"
                style={{
                  backgroundColor: 'rgba(239, 68, 68, 0.1)',
                  borderColor: '#EF4444',
                  color: '#EF4444',
                }}
              >
                {error}
              </div>
            )}

            {/* Login Button */}
            <button
              type="submit"
              disabled={loading}
              className="w-full px-6 py-3 rounded-lg font-bold text-lg transition-all duration-300 relative overflow-hidden"
              style={{
                background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                color: '#FFFFFF',
                opacity: loading ? 0.7 : 1,
                cursor: loading ? 'not-allowed' : 'pointer',
              }}
            >
              {loading ? 'Signing in...' : 'Sign In'}
            </button>
          </form>

          {/* Divider */}
          <div className="relative">
            <div className="absolute inset-0 flex items-center">
              <div className="w-full border-t" style={{ borderColor: 'var(--borderColor)' }} />
            </div>
            <div className="relative flex justify-center text-sm">
              <span 
                className="px-2"
                style={{ 
                  backgroundColor: 'var(--bgCard)',
                  color: 'var(--textSecondary)'
                }}
              >
                Don't have an account?
              </span>
            </div>
          </div>

          {/* Sign Up Link */}
          <Link 
            href="/signup"
            className="block text-center font-semibold transition-all duration-300 hover:opacity-80"
            style={{ color: 'var(--accent1)' }}
          >
            Create an account ‚Üí
          </Link>
        </div>

        {/* Back to Home */}
        <div className="text-center">
          <Link 
            href="/"
            className="text-sm font-medium transition-all duration-300 hover:opacity-80"
            style={{ color: 'var(--textSecondary)' }}
          >
            ‚Üê Back to home
          </Link>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="app/page.tsx">
import Link from 'next/link'
import { Button } from '@/components/ui/Button'
import { Card } from '@/components/ui/Card'

export default function Home() {
  return (
    <div className="max-w-4xl mx-auto">
      <div className="text-center space-y-8 py-12">
        {/* Hero Section */}
        <div className="space-y-4">
          <h1 className="text-5xl font-bold text-gray-900">
            Welcome to Apex Fitness Coach
          </h1>
          <p className="text-xl text-gray-600 max-w-2xl mx-auto">
            Upload your current and goal physique, we build an adaptive timeline 
            and workout plan that adjusts as you go.
          </p>
        </div>

        {/* CTA Buttons */}
        <div className="flex justify-center gap-4">
          <Link href="/onboarding">
            <Button variant="primary" size="lg">
              Get Started
            </Button>
          </Link>
          <Link href="/dashboard">
            <Button variant="secondary" size="lg">
              Go to Dashboard
            </Button>
          </Link>
        </div>

        {/* Feature Cards */}
        <div className="grid md:grid-cols-3 gap-6 mt-16">
          <Card>
            <h3 className="text-lg font-semibold text-gray-900 mb-2">
              AI-Powered Plans
            </h3>
            <p className="text-gray-600">
              Personalized workout plans generated using advanced AI
            </p>
          </Card>
          <Card>
            <h3 className="text-lg font-semibold text-gray-900 mb-2">
              Adaptive Timeline
            </h3>
            <p className="text-gray-600">
              Your plan adjusts based on your progress and feedback
            </p>
          </Card>
          <Card>
            <h3 className="text-lg font-semibold text-gray-900 mb-2">
              Track Progress
            </h3>
            <p className="text-gray-600">
              Visual tracking of your journey from start to goal
            </p>
          </Card>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="app/photos/upload/page.tsx">
'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'
import { useAuth } from '@/components/AuthProvider'
import { useTheme } from '@/components/ThemeProvider'
import { supabaseBrowser } from '@/lib/supabaseClient'

type PhotoType = 'front' | 'back' | 'side' | 'flexed' | 'relaxed'

interface CurrentPhoto {
  file: File
  preview: string
  type: PhotoType
}

interface GoalPhoto {
  file: File
  preview: string
  description: string
}

export default function PhotoUploadPage() {
  const router = useRouter()
  const { user } = useAuth()
  const { themeConfig } = useTheme()
  
  const [currentPhotos, setCurrentPhotos] = useState<CurrentPhoto[]>([])
  const [goalPhoto, setGoalPhoto] = useState<GoalPhoto | null>(null)
  const [uploading, setUploading] = useState(false)
  const [error, setError] = useState<string | null>(null)

  const handleCurrentPhotoUpload = (files: FileList | null, type: PhotoType) => {
    if (!files || files.length === 0) return
    
    const file = files[0]
    
    // Validate file type
    if (!file.type.startsWith('image/')) {
      setError('Please upload an image file')
      return
    }
    
    // Validate file size (5MB max)
    if (file.size > 5 * 1024 * 1024) {
      setError('Image must be less than 5MB')
      return
    }
    
    // Create preview
    const preview = URL.createObjectURL(file)
    
    // Add to current photos (max 5)
    if (currentPhotos.length >= 5) {
      setError('Maximum 5 current photos allowed')
      return
    }
    
    setCurrentPhotos(prev => [...prev, { file, preview, type }])
    setError(null)
  }

  const handleGoalPhotoUpload = (files: FileList | null) => {
    if (!files || files.length === 0) return
    
    const file = files[0]
    
    // Validate file type
    if (!file.type.startsWith('image/')) {
      setError('Please upload an image file')
      return
    }
    
    // Validate file size (5MB max)
    if (file.size > 5 * 1024 * 1024) {
      setError('Image must be less than 5MB')
      return
    }
    
    // Create preview
    const preview = URL.createObjectURL(file)
    
    setGoalPhoto({ file, preview, description: '' })
    setError(null)
  }

  const removeCurrentPhoto = (index: number) => {
    setCurrentPhotos(prev => {
      // Revoke object URL to prevent memory leak
      URL.revokeObjectURL(prev[index].preview)
      return prev.filter((_, i) => i !== index)
    })
  }

  const removeGoalPhoto = () => {
    if (goalPhoto) {
      URL.revokeObjectURL(goalPhoto.preview)
      setGoalPhoto(null)
    }
  }

  const handleSubmit = async () => {
    if (currentPhotos.length === 0) {
      setError('Please upload at least 1 current photo')
      return
    }
    
    if (!goalPhoto) {
      setError('Please upload a goal photo')
      return
    }
    
    setUploading(true)
    setError(null)
    
    try {
      const userId = user?.id
      if (!userId) throw new Error('User not authenticated')
      
      // Upload current photos
      for (let i = 0; i < currentPhotos.length; i++) {
        const photo = currentPhotos[i]
        const timestamp = Date.now()
        const filename = `current_${photo.type}_${timestamp}_${i}.${photo.file.name.split('.').pop()}`
        const filepath = `${userId}/${filename}`
        
        // Upload to Supabase Storage
        const { error: uploadError } = await supabaseBrowser.storage
          .from('physique-photos')
          .upload(filepath, photo.file)
        
        if (uploadError) throw uploadError
        
        // Get public URL
        const { data: { publicUrl } } = supabaseBrowser.storage
          .from('physique-photos')
          .getPublicUrl(filepath)
        
        // Save to database
        const { error: dbError } = await supabaseBrowser
          .from('user_current_photos')
          .insert({
            user_id: userId,
            photo_url: publicUrl,
            photo_type: photo.type,
            is_primary: i === 0 // First photo is primary
          })
        
        if (dbError) throw dbError
      }
      
      // Upload goal photo
      const timestamp = Date.now()
      const goalFilename = `goal_${timestamp}.${goalPhoto.file.name.split('.').pop()}`
      const goalFilepath = `${userId}/${goalFilename}`
      
      const { error: goalUploadError } = await supabaseBrowser.storage
        .from('physique-photos')
        .upload(goalFilepath, goalPhoto.file)
      
      if (goalUploadError) throw goalUploadError
      
      // Get public URL
      const { data: { publicUrl: goalPublicUrl } } = supabaseBrowser.storage
        .from('physique-photos')
        .getPublicUrl(goalFilepath)
      
      // Save to database
      const { error: goalDbError } = await supabaseBrowser
        .from('user_goal_photos')
        .insert({
          user_id: userId,
          photo_url: goalPublicUrl,
          description: goalPhoto.description || null
        })
      
      if (goalDbError) throw goalDbError
      
      // Success! Redirect to dashboard
      // TODO: In future, redirect to AI analysis page first
      router.push('/dashboard')
      
    } catch (err: any) {
      console.error('Upload error:', err)
      setError(err.message || 'Failed to upload photos')
    } finally {
      setUploading(false)
    }
  }

  const handleSkip = () => {
    router.push('/dashboard')
  }

  return (
    <div 
      className="min-h-screen p-8 transition-all duration-500"
      style={{ background: 'var(--bgPrimary)' }}
    >
      <div className="max-w-4xl mx-auto space-y-8">
        
        {/* Header */}
        <div className="text-center space-y-4">
          <h1 
            className="text-4xl font-bold"
            style={{
              background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              backgroundClip: 'text',
            }}
          >
            Show Us Where You're Starting üì∏
          </h1>
          <p className="text-lg" style={{ color: 'var(--textSecondary)' }}>
            Upload photos of your current physique and your goal. Our AI will analyze the gap and build your personalized plan.
          </p>
        </div>

        {/* Current Photos Section */}
        <div
          className="themed-card p-8 border-2 space-y-6"
          style={{
            backgroundColor: 'var(--bgCard)',
            borderColor: 'var(--borderColor)',
          }}
        >
          <div>
            <h2 
              className="text-2xl font-bold mb-2"
              style={{ color: 'var(--accent1)' }}
            >
              Your Current Physique
            </h2>
            <p className="text-sm" style={{ color: 'var(--textSecondary)' }}>
              Upload 1-5 photos (front, back, side views recommended for best analysis)
            </p>
          </div>

          {/* Upload Buttons */}
          <div className="grid grid-cols-2 md:grid-cols-5 gap-3">
            {(['front', 'back', 'side', 'flexed', 'relaxed'] as PhotoType[]).map((type) => (
              <div key={type}>
                <input
                  type="file"
                  accept="image/*"
                  id={`current-${type}`}
                  className="hidden"
                  onChange={(e) => handleCurrentPhotoUpload(e.target.files, type)}
                />
                <label
                  htmlFor={`current-${type}`}
                  className="block px-4 py-3 rounded-lg border-2 text-center font-semibold cursor-pointer transition-all duration-300 hover:scale-105"
                  style={{
                    backgroundColor: 'var(--bgSecondary)',
                    borderColor: 'var(--borderColor)',
                    color: 'var(--textPrimary)',
                  }}
                >
                  <div className="text-2xl mb-1">üì∑</div>
                  <div className="text-xs capitalize">{type}</div>
                </label>
              </div>
            ))}
          </div>

          {/* Current Photos Preview */}
          {currentPhotos.length > 0 && (
            <div className="space-y-3">
              <h3 className="font-semibold" style={{ color: 'var(--textPrimary)' }}>
                Uploaded ({currentPhotos.length}/5)
              </h3>
              <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
                {currentPhotos.map((photo, index) => (
                  <div key={index} className="relative group">
                    <img
                      src={photo.preview}
                      alt={`Current ${photo.type}`}
                      className="w-full h-40 object-cover rounded-lg border-2"
                      style={{ borderColor: 'var(--borderColor)' }}
                    />
                    <div className="absolute top-2 left-2 px-2 py-1 rounded text-xs font-semibold" style={{ backgroundColor: 'var(--accent1)', color: '#fff' }}>
                      {photo.type}
                    </div>
                    <button
                      onClick={() => removeCurrentPhoto(index)}
                      className="absolute top-2 right-2 w-6 h-6 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"
                      style={{ backgroundColor: '#EF4444', color: '#fff' }}
                    >
                      √ó
                    </button>
                  </div>
                ))}
              </div>
            </div>
          )}
        </div>

        {/* Goal Photo Section */}
        <div
          className="themed-card p-8 border-2 space-y-6"
          style={{
            backgroundColor: 'var(--bgCard)',
            borderColor: 'var(--borderColor)',
          }}
        >
          <div>
            <h2 
              className="text-2xl font-bold mb-2"
              style={{ color: 'var(--accent2)' }}
            >
              Your Goal Physique
            </h2>
            <p className="text-sm" style={{ color: 'var(--textSecondary)' }}>
              Upload a photo of your goal body (celebrity, athlete, or personal inspiration)
            </p>
          </div>

          {!goalPhoto ? (
            <div>
              <input
                type="file"
                accept="image/*"
                id="goal-photo"
                className="hidden"
                onChange={(e) => handleGoalPhotoUpload(e.target.files)}
              />
              <label
                htmlFor="goal-photo"
                className="block w-full p-12 rounded-lg border-2 border-dashed text-center cursor-pointer transition-all duration-300 hover:scale-102"
                style={{
                  borderColor: 'var(--borderColor)',
                  backgroundColor: 'var(--bgSecondary)',
                }}
              >
                <div className="text-6xl mb-4">üéØ</div>
                <div className="font-bold text-lg mb-2" style={{ color: 'var(--textPrimary)' }}>
                  Click to Upload Goal Photo
                </div>
                <div className="text-sm" style={{ color: 'var(--textSecondary)' }}>
                  JPG, PNG, or WebP ‚Ä¢ Max 5MB
                </div>
              </label>
            </div>
          ) : (
            <div className="space-y-4">
              <div className="relative group">
                <img
                  src={goalPhoto.preview}
                  alt="Goal physique"
                  className="w-full max-w-md mx-auto rounded-lg border-2"
                  style={{ borderColor: 'var(--borderColor)' }}
                />
                <button
                  onClick={removeGoalPhoto}
                  className="absolute top-4 right-4 px-4 py-2 rounded-lg font-semibold opacity-0 group-hover:opacity-100 transition-opacity"
                  style={{ backgroundColor: '#EF4444', color: '#fff' }}
                >
                  Remove
                </button>
              </div>
              
              <div className="space-y-2">
                <label className="block text-sm font-semibold" style={{ color: 'var(--textPrimary)' }}>
                  Who is this? (Optional)
                </label>
                <input
                  type="text"
                  value={goalPhoto.description}
                  onChange={(e) => setGoalPhoto({ ...goalPhoto, description: e.target.value })}
                  className="w-full px-4 py-3 rounded-lg border-2"
                  style={{
                    backgroundColor: 'var(--bgSecondary)',
                    borderColor: 'var(--borderColor)',
                    color: 'var(--textPrimary)',
                  }}
                  placeholder="e.g., Michael B Jordan - Creed 2, Chris Hemsworth - Thor"
                />
              </div>
            </div>
          )}
        </div>

        {/* Error Message */}
        {error && (
          <div 
            className="p-4 rounded-lg border-2"
            style={{
              backgroundColor: 'rgba(239, 68, 68, 0.1)',
              borderColor: '#EF4444',
              color: '#EF4444',
            }}
          >
            {error}
          </div>
        )}

        {/* Action Buttons */}
        <div className="flex gap-4">
          <button
            onClick={handleSkip}
            disabled={uploading}
            className="px-6 py-3 rounded-lg font-semibold border-2 transition-all duration-300 hover:opacity-80"
            style={{
              borderColor: 'var(--borderColor)',
              color: 'var(--textSecondary)',
            }}
          >
            Skip for Now
          </button>
          
          <button
            onClick={handleSubmit}
            disabled={uploading || currentPhotos.length === 0 || !goalPhoto}
            className="flex-1 px-6 py-4 rounded-lg font-bold text-lg transition-all duration-300 hover:scale-105"
            style={{
              background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
              color: '#FFFFFF',
              opacity: uploading || currentPhotos.length === 0 || !goalPhoto ? 0.5 : 1,
              cursor: uploading || currentPhotos.length === 0 || !goalPhoto ? 'not-allowed' : 'pointer',
            }}
          >
            {uploading ? 'Uploading Photos...' : 'Analyze My Physique üöÄ'}
          </button>
        </div>

        {/* Help Text */}
        <div 
          className="text-center text-sm p-4 rounded-lg"
          style={{
            backgroundColor: 'var(--bgSecondary)',
            color: 'var(--textSecondary)',
          }}
        >
          <p className="mb-2">
            üí° <strong>Pro Tip:</strong> Good lighting and clear poses help our AI give you the most accurate analysis and timeline!
          </p>
          <p>
            Your photos are private and secure. Only you can see them.
          </p>
        </div>

      </div>
    </div>
  )
}
</file>

<file path="app/signup/page.tsx">
'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'
import Link from 'next/link'
import { supabaseBrowser } from '@/lib/supabaseClient'
import { useTheme } from '@/components/ThemeProvider'

export default function SignupPage() {
  const router = useRouter()
  const { themeConfig } = useTheme()
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [confirmPassword, setConfirmPassword] = useState('')
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState<string | null>(null)
  const [success, setSuccess] = useState(false)

  const handleSignup = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError(null)

    // Validate passwords match
    if (password !== confirmPassword) {
      setError('Passwords do not match')
      setLoading(false)
      return
    }

    // Validate password length
    if (password.length < 6) {
      setError('Password must be at least 6 characters')
      setLoading(false)
      return
    }

    try {
      const { data, error } = await supabaseBrowser.auth.signUp({
        email,
        password,
      })

      if (error) throw error

      // Success!
      setSuccess(true)
      
      // Redirect to login after 2 seconds
      setTimeout(() => {
        router.push('/login')
      }, 2000)
    } catch (err: any) {
      setError(err.message || 'Signup failed')
    } finally {
      setLoading(false)
    }
  }

  return (
    <div 
      className="min-h-screen flex items-center justify-center p-8 transition-all duration-500"
      style={{ background: `var(--bgPrimary)` }}
    >
      <div className="w-full max-w-md space-y-8">
        
        {/* Header */}
        <div className="text-center space-y-2">
          <h1 
            className="text-4xl font-bold"
            style={{
              background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              backgroundClip: 'text',
            }}
          >
            Start Your Journey
          </h1>
          <p style={{ color: 'var(--textSecondary)' }}>
            Create your Apex Fitness Coach account
          </p>
        </div>

        {/* Signup Card */}
        <div
          className="themed-card p-8 border-2 space-y-6"
          style={{
            backgroundColor: 'var(--bgCard)',
            borderColor: 'var(--borderColor)',
          }}
        >
          {success ? (
            // Success Message
            <div className="text-center space-y-4 py-8">
              <div 
                className="text-5xl mb-4"
                style={{ color: 'var(--accent1)' }}
              >
                ‚úì
              </div>
              <h3 
                className="text-2xl font-bold"
                style={{ color: 'var(--textPrimary)' }}
              >
                Account Created!
              </h3>
              <p style={{ color: 'var(--textSecondary)' }}>
                Check your email to verify your account.
              </p>
              <p style={{ color: 'var(--textSecondary)' }} className="text-sm">
                Redirecting to login...
              </p>
            </div>
          ) : (
            // Signup Form
            <form onSubmit={handleSignup} className="space-y-6">
              
              {/* Email Input */}
              <div className="space-y-2">
                <label 
                  htmlFor="email" 
                  className="block text-sm font-semibold"
                  style={{ color: 'var(--textPrimary)' }}
                >
                  Email
                </label>
                <input
                  id="email"
                  type="email"
                  value={email}
                  onChange={(e) => setEmail(e.target.value)}
                  required
                  className="w-full px-4 py-3 rounded-lg border-2 transition-all duration-300 focus:outline-none focus:ring-2"
                  style={{
                    backgroundColor: 'var(--bgSecondary)',
                    borderColor: 'var(--borderColor)',
                    color: 'var(--textPrimary)',
                  }}
                  placeholder="your@email.com"
                />
              </div>

              {/* Password Input */}
              <div className="space-y-2">
                <label 
                  htmlFor="password" 
                  className="block text-sm font-semibold"
                  style={{ color: 'var(--textPrimary)' }}
                >
                  Password
                </label>
                <input
                  id="password"
                  type="password"
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  required
                  className="w-full px-4 py-3 rounded-lg border-2 transition-all duration-300 focus:outline-none focus:ring-2"
                  style={{
                    backgroundColor: 'var(--bgSecondary)',
                    borderColor: 'var(--borderColor)',
                    color: 'var(--textPrimary)',
                  }}
                  placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                />
                <p className="text-xs" style={{ color: 'var(--textSecondary)' }}>
                  Must be at least 6 characters
                </p>
              </div>

              {/* Confirm Password Input */}
              <div className="space-y-2">
                <label 
                  htmlFor="confirmPassword" 
                  className="block text-sm font-semibold"
                  style={{ color: 'var(--textPrimary)' }}
                >
                  Confirm Password
                </label>
                <input
                  id="confirmPassword"
                  type="password"
                  value={confirmPassword}
                  onChange={(e) => setConfirmPassword(e.target.value)}
                  required
                  className="w-full px-4 py-3 rounded-lg border-2 transition-all duration-300 focus:outline-none focus:ring-2"
                  style={{
                    backgroundColor: 'var(--bgSecondary)',
                    borderColor: 'var(--borderColor)',
                    color: 'var(--textPrimary)',
                  }}
                  placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                />
              </div>

              {/* Error Message */}
              {error && (
                <div 
                  className="p-4 rounded-lg border-2"
                  style={{
                    backgroundColor: 'rgba(239, 68, 68, 0.1)',
                    borderColor: '#EF4444',
                    color: '#EF4444',
                  }}
                >
                  {error}
                </div>
              )}

              {/* Signup Button */}
              <button
                type="submit"
                disabled={loading}
                className="w-full px-6 py-3 rounded-lg font-bold text-lg transition-all duration-300 relative overflow-hidden"
                style={{
                  background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                  color: '#FFFFFF',
                  opacity: loading ? 0.7 : 1,
                  cursor: loading ? 'not-allowed' : 'pointer',
                }}
              >
                {loading ? 'Creating account...' : 'Create Account'}
              </button>
            </form>
          )}

          {!success && (
            <>
              {/* Divider */}
              <div className="relative">
                <div className="absolute inset-0 flex items-center">
                  <div className="w-full border-t" style={{ borderColor: 'var(--borderColor)' }} />
                </div>
                <div className="relative flex justify-center text-sm">
                  <span 
                    className="px-2"
                    style={{ 
                      backgroundColor: 'var(--bgCard)',
                      color: 'var(--textSecondary)'
                    }}
                  >
                    Already have an account?
                  </span>
                </div>
              </div>

              {/* Login Link */}
              <Link 
                href="/login"
                className="block text-center font-semibold transition-all duration-300 hover:opacity-80"
                style={{ color: 'var(--accent1)' }}
              >
                Sign in instead ‚Üí
              </Link>
            </>
          )}
        </div>

        {/* Back to Home */}
        <div className="text-center">
          <Link 
            href="/"
            className="text-sm font-medium transition-all duration-300 hover:opacity-80"
            style={{ color: 'var(--textSecondary)' }}
          >
            ‚Üê Back to home
          </Link>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="app/test/page.tsx">
'use client'

import { CyberButton } from '@/components/cyber/CyberButton'
import { ThemeSwitcher } from '@/components/ThemeSwitcher'
import { useTheme } from '@/components/ThemeProvider'

export default function TestPage() {
  const { themeConfig } = useTheme()

  return (
    <div 
      className="min-h-screen flex items-center justify-center p-8 transition-all duration-500"
      style={{ background: `var(--bgPrimary)` }}
    >
      <div className="max-w-5xl w-full space-y-12">
        
        {/* Theme Switcher */}
        <div className="space-y-4">
          <h2 
            className="text-center text-2xl font-bold"
            style={{ color: 'var(--textPrimary)' }}
          >
            Choose Your Theme
          </h2>
          <ThemeSwitcher />
        </div>

        {/* Title */}
        <div className="text-center space-y-4">
          <h1 
            className="text-5xl font-bold"
            style={{
              background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2}, ${themeConfig.colors.accent3})`,
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              backgroundClip: 'text',
            }}
          >
            {themeConfig.displayName} Theme
          </h1>
          <p style={{ color: 'var(--textSecondary)' }} className="text-lg">
            {themeConfig.description}
          </p>
          <p style={{ color: 'var(--textSecondary)' }} className="text-sm">
            Shape: {themeConfig.shape} | Animation: {themeConfig.animation}
          </p>
        </div>

        {/* Color Palette Display */}
        <div className="space-y-4">
          <h3 
            className="text-xl font-bold text-center"
            style={{ color: 'var(--textPrimary)' }}
          >
            Color Palette
          </h3>
          <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div className="space-y-2">
              <div 
                className="h-20 rounded-lg border-2 transition-all hover:scale-105"
                style={{ 
                  backgroundColor: themeConfig.colors.accent1,
                  borderColor: themeConfig.colors.borderColor 
                }}
              />
              <p className="text-xs text-center font-semibold" style={{ color: 'var(--textSecondary)' }}>
                Accent 1
              </p>
            </div>
            
            <div className="space-y-2">
              <div 
                className="h-20 rounded-lg border-2 transition-all hover:scale-105"
                style={{ 
                  backgroundColor: themeConfig.colors.accent2,
                  borderColor: themeConfig.colors.borderColor 
                }}
              />
              <p className="text-xs text-center font-semibold" style={{ color: 'var(--textSecondary)' }}>
                Accent 2
              </p>
            </div>
            
            <div className="space-y-2">
              <div 
                className="h-20 rounded-lg border-2 transition-all hover:scale-105"
                style={{ 
                  backgroundColor: themeConfig.colors.accent3,
                  borderColor: themeConfig.colors.borderColor 
                }}
              />
              <p className="text-xs text-center font-semibold" style={{ color: 'var(--textSecondary)' }}>
                Accent 3
              </p>
            </div>
            
            <div className="space-y-2">
              <div 
                className="h-20 rounded-lg border-2 transition-all hover:scale-105"
                style={{ 
                  backgroundColor: themeConfig.colors.accent4,
                  borderColor: themeConfig.colors.borderColor 
                }}
              />
              <p className="text-xs text-center font-semibold" style={{ color: 'var(--textSecondary)' }}>
                Accent 4
              </p>
            </div>
          </div>
          
          {/* Show Queen accent for Bee theme */}
          {themeConfig.colors.accentSpecial && (
            <div className="flex justify-center">
              <div className="space-y-2 w-48">
                <div 
                  className="h-20 rounded-lg border-2 transition-all hover:scale-105 relative overflow-hidden"
                  style={{ 
                    backgroundColor: themeConfig.colors.accentSpecial,
                    borderColor: themeConfig.colors.borderColor 
                  }}
                >
                  <div className="absolute top-2 right-2 text-2xl">üëë</div>
                </div>
                <p className="text-xs text-center font-bold" style={{ color: 'var(--textSecondary)' }}>
                  üëë Queen Accent (Special)
                </p>
              </div>
            </div>
          )}
        </div>

        {/* Sample Cards */}
        <div className="space-y-4">
          <h3 
            className="text-xl font-bold text-center"
            style={{ color: 'var(--textPrimary)' }}
          >
            Sample Cards
          </h3>
          <div className="grid md:grid-cols-3 gap-6">
            <div 
              className="themed-card p-6 border-2 transition-all hover:scale-105"
              style={{ 
                backgroundColor: 'var(--bgCard)',
                borderColor: 'var(--borderColor)'
              }}
            >
              <h4 className="font-bold mb-2" style={{ color: 'var(--accent1)' }}>
                Progress Card
              </h4>
              <p style={{ color: 'var(--textSecondary)' }}>
                This card adapts to the current theme automatically.
              </p>
            </div>
            
            <div 
              className="themed-card p-6 border-2 transition-all hover:scale-105"
              style={{ 
                backgroundColor: 'var(--bgCard)',
                borderColor: 'var(--borderColor)'
              }}
            >
              <h4 className="font-bold mb-2" style={{ color: 'var(--accent2)' }}>
                Stats Card
              </h4>
              <p style={{ color: 'var(--textSecondary)' }}>
                Notice how colors change smoothly between themes.
              </p>
            </div>
            
            <div 
              className="themed-card p-6 border-2 transition-all hover:scale-105"
              style={{ 
                backgroundColor: 'var(--bgCard)',
                borderColor: 'var(--borderColor)'
              }}
            >
              <h4 className="font-bold mb-2" style={{ color: 'var(--accent3)' }}>
                Achievement Card
              </h4>
              <p style={{ color: 'var(--textSecondary)' }}>
                Shape adapts based on theme: angular, rounded, or hexagonal.
              </p>
            </div>
          </div>
        </div>

        {/* Test existing CyberButton */}
        <div className="space-y-4">
          <h3 
            className="text-xl font-bold text-center"
            style={{ color: 'var(--textPrimary)' }}
          >
            Old CyberButton (Not Theme-Aware Yet)
          </h3>
          <div className="flex flex-wrap justify-center gap-4">
            <CyberButton variant="primary" size="md">
              Primary
            </CyberButton>
            <CyberButton variant="secondary" size="md">
              Secondary
            </CyberButton>
            <CyberButton variant="outline" size="md">
              Outline
            </CyberButton>
          </div>
          <p className="text-center text-sm" style={{ color: 'var(--textSecondary)' }}>
            ‚¨ÜÔ∏è These buttons don't change with theme - we'll build theme-aware buttons tomorrow!
          </p>
        </div>

      </div>
    </div>
  )
}
</file>

<file path="components/AuthProvider.tsx">
'use client'

import { createContext, useContext, useEffect, useState, ReactNode } from 'react'
import { User } from '@supabase/supabase-js'
import { supabaseBrowser } from '@/lib/supabaseClient'
import { useRouter } from 'next/navigation'

interface AuthContextType {
  user: User | null
  loading: boolean
  signOut: () => Promise<void>
}

const AuthContext = createContext<AuthContextType | undefined>(undefined)

export function AuthProvider({ children }: { children: ReactNode }) {
  const [user, setUser] = useState<User | null>(null)
  const [loading, setLoading] = useState(true)
  const router = useRouter()

  useEffect(() => {
    // Check active session
    const checkSession = async () => {
      try {
        const { data: { session } } = await supabaseBrowser.auth.getSession()
        setUser(session?.user ?? null)
      } catch (error) {
        console.error('Error checking session:', error)
      } finally {
        setLoading(false)
      }
    }

    checkSession()

    // Listen for auth changes
    const { data: { subscription } } = supabaseBrowser.auth.onAuthStateChange(
      async (event, session) => {
        setUser(session?.user ?? null)
        setLoading(false)

        // Redirect based on auth state
        if (event === 'SIGNED_IN') {
          router.push('/dashboard')
        } else if (event === 'SIGNED_OUT') {
          router.push('/login')
        }
      }
    )

    return () => {
      subscription.unsubscribe()
    }
  }, [router])

  const signOut = async () => {
    try {
      await supabaseBrowser.auth.signOut()
      setUser(null)
      router.push('/login')
    } catch (error) {
      console.error('Error signing out:', error)
    }
  }

  return (
    <AuthContext.Provider value={{ user, loading, signOut }}>
      {children}
    </AuthContext.Provider>
  )
}

export function useAuth() {
  const context = useContext(AuthContext)
  if (context === undefined) {
    throw new Error('useAuth must be used within an AuthProvider')
  }
  return context
}
</file>

<file path="components/cyber/CyberButton.tsx">
'use client'

import { ButtonHTMLAttributes, ReactNode } from 'react'

interface CyberButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'primary' | 'secondary' | 'outline'
  size?: 'sm' | 'md' | 'lg'
  children: ReactNode
  glow?: boolean
}

export function CyberButton({
  variant = 'primary',
  size = 'md',
  glow = true,
  className = '',
  children,
  ...props
}: CyberButtonProps) {
  const baseStyles = 'font-bold uppercase tracking-wider transition-all duration-300 relative overflow-hidden group'
  
  const variantStyles = {
    primary: `
      bg-gradient-to-r from-cyan-500 to-blue-500
      text-white
      border-2 border-cyan-400
      hover:from-cyan-400 hover:to-blue-400
      hover:border-cyan-300
      hover:shadow-[0_0_20px_rgba(34,211,238,0.6)]
      active:scale-95
    `,
    secondary: `
      bg-gradient-to-r from-pink-500 to-purple-500
      text-white
      border-2 border-pink-400
      hover:from-pink-400 hover:to-purple-400
      hover:border-pink-300
      hover:shadow-[0_0_20px_rgba(236,72,153,0.6)]
      active:scale-95
    `,
    outline: `
      bg-transparent
      text-cyan-400
      border-2 border-cyan-400
      hover:bg-cyan-400/10
      hover:border-cyan-300
      hover:shadow-[0_0_15px_rgba(34,211,238,0.4)]
      active:scale-95
    `,
  }
  
  const sizeStyles = {
    sm: 'px-4 py-2 text-xs',
    md: 'px-6 py-3 text-sm',
    lg: 'px-8 py-4 text-base',
  }

  const glowEffect = glow ? 'before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/20 before:to-transparent before:translate-x-[-200%] hover:before:translate-x-[200%] before:transition-transform before:duration-700' : ''

  return (
    <button
      className={`
        ${baseStyles}
        ${variantStyles[variant]}
        ${sizeStyles[size]}
        ${glowEffect}
        ${className}
        clip-path-hex
      `}
      {...props}
    >
      {/* Animated background pulse */}
      <span className="absolute inset-0 bg-gradient-to-r from-cyan-500/0 via-cyan-500/20 to-cyan-500/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 animate-pulse-slow" />
      
      {/* Button content */}
      <span className="relative z-10 flex items-center justify-center gap-2">
        {children}
      </span>
    </button>
  )
}
</file>

<file path="components/ThemeProvider.tsx">
'use client'

import { createContext, useContext, useState, useEffect, ReactNode } from 'react'
import { ThemeName, themes } from '@/lib/themes'

interface ThemeContextType {
  theme: ThemeName
  setTheme: (theme: ThemeName) => void
  themeConfig: typeof themes[ThemeName]
}

const ThemeContext = createContext<ThemeContextType | undefined>(undefined)

export function ThemeProvider({ children }: { children: ReactNode }) {
  const [theme, setThemeState] = useState<ThemeName>('cyberpunk')

  // Load theme from localStorage on mount
  useEffect(() => {
    const savedTheme = localStorage.getItem('apex-theme') as ThemeName
    if (savedTheme && themes[savedTheme]) {
      setThemeState(savedTheme)
    }
  }, [])

  // Apply theme to document
  useEffect(() => {
    const currentTheme = themes[theme]
    document.documentElement.setAttribute('data-theme', theme)
    
    // Apply CSS variables
    const colors = currentTheme.colors
    Object.entries(colors).forEach(([key, value]) => {
      if (value) {
        document.documentElement.style.setProperty(`--${key}`, value)
      }
    })
    
    // Apply shape and animation preferences as data attributes
    document.documentElement.setAttribute('data-shape', currentTheme.shape)
    document.documentElement.setAttribute('data-animation', currentTheme.animation)
  }, [theme])

  const setTheme = (newTheme: ThemeName) => {
    setThemeState(newTheme)
    localStorage.setItem('apex-theme', newTheme)
  }

  return (
    <ThemeContext.Provider value={{ theme, setTheme, themeConfig: themes[theme] }}>
      {children}
    </ThemeContext.Provider>
  )
}

export function useTheme() {
  const context = useContext(ThemeContext)
  if (context === undefined) {
    throw new Error('useTheme must be used within a ThemeProvider')
  }
  return context
}
</file>

<file path="components/ThemeSwitcher.tsx">
'use client'

import { useTheme } from './ThemeProvider'
import { themes, ThemeName } from '@/lib/themes'

export function ThemeSwitcher() {
  const { theme, setTheme } = useTheme()

  return (
    <div className="flex flex-wrap gap-3 justify-center">
      {Object.values(themes).map((themeConfig) => (
        <button
          key={themeConfig.name}
          onClick={() => setTheme(themeConfig.name)}
          className={`
            px-5 py-3 rounded-lg font-bold text-sm
            transition-all duration-300 relative overflow-hidden
            border-2
            ${theme === themeConfig.name 
              ? 'scale-105 shadow-lg' 
              : 'opacity-70 hover:opacity-100 hover:scale-102'
            }
          `}
          style={{
            background: theme === themeConfig.name 
              ? `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`
              : themeConfig.colors.bgCard,
            borderColor: themeConfig.colors.accent1,
            color: theme === themeConfig.name ? '#ffffff' : themeConfig.colors.textPrimary,
          }}
        >
          <span className="relative z-10 flex items-center gap-2">
            {/* Theme icon/indicator */}
            <span 
              className="w-3 h-3 rounded-full"
              style={{ 
                background: themeConfig.colors.accent1,
                boxShadow: `0 0 8px ${themeConfig.colors.accent1}`
              }}
            />
            {themeConfig.displayName}
          </span>
          
          {/* Hover effect */}
          {theme !== themeConfig.name && (
            <span 
              className="absolute inset-0 opacity-0 hover:opacity-10 transition-opacity"
              style={{ background: themeConfig.colors.accent1 }}
            />
          )}
        </button>
      ))}
    </div>
  )
}
</file>

<file path="components/ui/Button.tsx">
import { ButtonHTMLAttributes, ReactNode } from 'react'

interface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'primary' | 'secondary' | 'outline'
  size?: 'sm' | 'md' | 'lg'
  children: ReactNode
}

export function Button({
  variant = 'primary',
  size = 'md',
  className = '',
  children,
  ...props
}: ButtonProps) {
  const baseStyles = 'font-semibold rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2'
  
  const variantStyles = {
    primary: 'bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500',
    secondary: 'bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500',
    outline: 'border-2 border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-gray-500',
  }
  
  const sizeStyles = {
    sm: 'px-3 py-1.5 text-sm',
    md: 'px-4 py-2 text-base',
    lg: 'px-6 py-3 text-lg',
  }

  return (
    <button
      className={`${baseStyles} ${variantStyles[variant]} ${sizeStyles[size]} ${className}`}
      {...props}
    >
      {children}
    </button>
  )
}
</file>

<file path="components/ui/Card.tsx">
import { ReactNode } from 'react'

interface CardProps {
  children: ReactNode
  className?: string
}

export function Card({ children, className = '' }: CardProps) {
  return (
    <div className={`bg-white rounded-lg shadow-md p-6 ${className}`}>
      {children}
    </div>
  )
}
</file>

<file path="eslint.config.mjs">
import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  {
    ...nextVitals,
    ...nextTs,

    // Add custom rule overrides here
    rules: {
      "react/no-unescaped-entities": "off",
    },
  },

  // Global ignores
  globalIgnores([
    ".next/**",
    "out/**",
    "build/**",
    "next-env.d.ts",
  ]),
]);

export default eslintConfig;
</file>

<file path="lib/themes.ts">
export type ThemeName = 'cyberpunk' | 'pastel' | 'minimal' | 'bee'

export interface Theme {
  name: ThemeName
  displayName: string
  description: string
  colors: {
    // Backgrounds
    bgPrimary: string
    bgSecondary: string
    bgCard: string
    
    // Text
    textPrimary: string
    textSecondary: string
    
    // Accent colors
    accent1: string // Primary accent
    accent2: string // Secondary accent
    accent3: string // Tertiary accent
    accent4: string // Additional accent
    
    // Special accents
    accentSpecial?: string // Optional special accent (like Queen purple for bee)
    
    // Borders & effects
    borderColor: string
    glowIntensity: string
    shadowIntensity: string
    
    // Theme-specific
    progressFill: string // Color for progress bars/fills
  }
  // Visual characteristics
  shape: 'angular' | 'rounded' | 'hexagonal' // Primary shape language
  animation: 'neon' | 'subtle' | 'minimal' | 'organic' // Animation style
}

export const themes: Record<ThemeName, Theme> = {
  cyberpunk: {
    name: 'cyberpunk',
    displayName: 'Cyberpunk',
    description: 'Neon futuristic aesthetic',
    shape: 'angular',
    animation: 'neon',
    colors: {
      bgPrimary: '#0a0014',
      bgSecondary: '#1a0033',
      bgCard: '#1a0033',
      textPrimary: '#ffffff',
      textSecondary: '#a0a0a0',
      accent1: '#00f0ff', // Cyan
      accent2: '#ff00ff', // Pink
      accent3: '#8b00ff', // Purple
      accent4: '#0066ff', // Blue
      borderColor: '#00f0ff',
      glowIntensity: '20px',
      shadowIntensity: '0.6',
      progressFill: '#00f0ff',
    },
  },
  
  pastel: {
    name: 'pastel',
    displayName: 'Soft Pastel',
    description: 'Calm and soothing aesthetic',
    shape: 'rounded',
    animation: 'subtle',
    colors: {
      bgPrimary: '#FFF9F0', // Soft cream/ivory
      bgSecondary: '#FFF5EB', // Slightly warmer cream
      bgCard: '#FFFFFF', // Pure white cards
      textPrimary: '#5A4A42', // Warm dark brown
      textSecondary: '#9B8B7E', // Muted taupe
      accent1: '#B8E6E1', // Soft aqua/mint
      accent2: '#F5B8B8', // Blush pink
      accent3: '#EAACB4', // Rose pink
      accent4: '#E8D5F2', // Lavender mist
      borderColor: '#E8D5F2', // Lavender border
      glowIntensity: '8px',
      shadowIntensity: '0.2',
      progressFill: '#B8E6E1', // Aqua fill
    },
  },
  
  minimal: {
    name: 'minimal',
    displayName: 'Minimal Light',
    description: 'Clean and timeless design',
    shape: 'rounded',
    animation: 'minimal',
    colors: {
      bgPrimary: '#FFFFFF', // Pure white
      bgSecondary: '#F7F7F7', // Off white
      bgCard: '#FFFFFF', // White cards
      textPrimary: '#1F2937', // Dark slate
      textSecondary: '#6B7280', // Medium gray
      accent1: '#4A90E2', // Soft blue (professional)
      accent2: '#6B7280', // Slate gray
      accent3: '#9CA3AF', // Light gray
      accent4: '#D1D5DB', // Very light gray
      borderColor: '#E5E7EB', // Light border
      glowIntensity: '2px',
      shadowIntensity: '0.1',
      progressFill: '#4A90E2', // Blue fill
    },
  },
  
  bee: {
    name: 'bee',
    displayName: 'Bee Hive',
    description: 'Warm nature-inspired premium',
    shape: 'hexagonal',
    animation: 'organic',
    colors: {
      bgPrimary: '#1F1F1F', // Charcoal Black
      bgSecondary: '#2a2a2a',
      bgCard: '#2a2a2a',
      textPrimary: '#FFF6D6', // Soft Cream
      textSecondary: '#c9b88c',
      accent1: '#FFC83D', // Honey Gold (primary)
      accent2: '#FFB000', // Warm Amber (secondary)
      accent3: '#FFE066', // Pollen Yellow
      accent4: '#4CAF50', // Leaf Green
      accentSpecial: '#6B4EFF', // Royal Purple (Queen accent)
      borderColor: '#FFC83D',
      glowIntensity: '12px',
      shadowIntensity: '0.4',
      progressFill: '#FFB000', // Honey fill
    },
  },
}
</file>

<file path="next-env.d.ts">
/// <reference types="next" />
/// <reference types="next/image-types/global" />
import "./.next/dev/types/routes.d.ts";

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.
</file>

<file path="next.config.ts">
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
};

export default nextConfig;
</file>

<file path="postcss.config.mjs">
const config = {
  plugins: {
    "@tailwindcss/postcss": {},
  },
};

export default config;
</file>

<file path="public/file.svg">
<svg fill="none" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 13.5V5.41a1 1 0 0 0-.3-.7L9.8.29A1 1 0 0 0 9.08 0H1.5v13.5A2.5 2.5 0 0 0 4 16h8a2.5 2.5 0 0 0 2.5-2.5m-1.5 0v-7H8v-5H3v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1M9.5 5V2.12L12.38 5zM5.13 5h-.62v1.25h2.12V5zm-.62 3h7.12v1.25H4.5zm.62 3h-.62v1.25h7.12V11z" clip-rule="evenodd" fill="#666" fill-rule="evenodd"/></svg>
</file>

<file path="public/globe.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g clip-path="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.27 14.1a6.5 6.5 0 0 0 3.67-3.45q-1.24.21-2.7.34-.31 1.83-.97 3.1M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.48-1.52a7 7 0 0 1-.96 0H7.5a4 4 0 0 1-.84-1.32q-.38-.89-.63-2.08a40 40 0 0 0 3.92 0q-.25 1.2-.63 2.08a4 4 0 0 1-.84 1.31zm2.94-4.76q1.66-.15 2.95-.43a7 7 0 0 0 0-2.58q-1.3-.27-2.95-.43a18 18 0 0 1 0 3.44m-1.27-3.54a17 17 0 0 1 0 3.64 39 39 0 0 1-4.3 0 17 17 0 0 1 0-3.64 39 39 0 0 1 4.3 0m1.1-1.17q1.45.13 2.69.34a6.5 6.5 0 0 0-3.67-3.44q.65 1.26.98 3.1M8.48 1.5l.01.02q.41.37.84 1.31.38.89.63 2.08a40 40 0 0 0-3.92 0q.25-1.2.63-2.08a4 4 0 0 1 .85-1.32 7 7 0 0 1 .96 0m-2.75.4a6.5 6.5 0 0 0-3.67 3.44 29 29 0 0 1 2.7-.34q.31-1.83.97-3.1M4.58 6.28q-1.66.16-2.95.43a7 7 0 0 0 0 2.58q1.3.27 2.95.43a18 18 0 0 1 0-3.44m.17 4.71q-1.45-.12-2.69-.34a6.5 6.5 0 0 0 3.67 3.44q-.65-1.27-.98-3.1" fill="#666"/></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h16v16H0z"/></clipPath></defs></svg>
</file>

<file path="public/next.svg">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 394 80"><path fill="#000" d="M262 0h68.5v12.7h-27.2v66.6h-13.6V12.7H262V0ZM149 0v12.7H94v20.4h44.3v12.6H94v21h55v12.6H80.5V0h68.7zm34.3 0h-17.8l63.8 79.4h17.9l-32-39.7 32-39.6h-17.9l-23 28.6-23-28.6zm18.3 56.7-9-11-27.1 33.7h17.8l18.3-22.7z"/><path fill="#000" d="M81 79.3 17 0H0v79.3h13.6V17l50.2 62.3H81Zm252.6-.4c-1 0-1.8-.4-2.5-1s-1.1-1.6-1.1-2.6.3-1.8 1-2.5 1.6-1 2.6-1 1.8.3 2.5 1a3.4 3.4 0 0 1 .6 4.3 3.7 3.7 0 0 1-3 1.8zm23.2-33.5h6v23.3c0 2.1-.4 4-1.3 5.5a9.1 9.1 0 0 1-3.8 3.5c-1.6.8-3.5 1.3-5.7 1.3-2 0-3.7-.4-5.3-1s-2.8-1.8-3.7-3.2c-.9-1.3-1.4-3-1.4-5h6c.1.8.3 1.6.7 2.2s1 1.2 1.6 1.5c.7.4 1.5.5 2.4.5 1 0 1.8-.2 2.4-.6a4 4 0 0 0 1.6-1.8c.3-.8.5-1.8.5-3V45.5zm30.9 9.1a4.4 4.4 0 0 0-2-3.3 7.5 7.5 0 0 0-4.3-1.1c-1.3 0-2.4.2-3.3.5-.9.4-1.6 1-2 1.6a3.5 3.5 0 0 0-.3 4c.3.5.7.9 1.3 1.2l1.8 1 2 .5 3.2.8c1.3.3 2.5.7 3.7 1.2a13 13 0 0 1 3.2 1.8 8.1 8.1 0 0 1 3 6.5c0 2-.5 3.7-1.5 5.1a10 10 0 0 1-4.4 3.5c-1.8.8-4.1 1.2-6.8 1.2-2.6 0-4.9-.4-6.8-1.2-2-.8-3.4-2-4.5-3.5a10 10 0 0 1-1.7-5.6h6a5 5 0 0 0 3.5 4.6c1 .4 2.2.6 3.4.6 1.3 0 2.5-.2 3.5-.6 1-.4 1.8-1 2.4-1.7a4 4 0 0 0 .8-2.4c0-.9-.2-1.6-.7-2.2a11 11 0 0 0-2.1-1.4l-3.2-1-3.8-1c-2.8-.7-5-1.7-6.6-3.2a7.2 7.2 0 0 1-2.4-5.7 8 8 0 0 1 1.7-5 10 10 0 0 1 4.3-3.5c2-.8 4-1.2 6.4-1.2 2.3 0 4.4.4 6.2 1.2 1.8.8 3.2 2 4.3 3.4 1 1.4 1.5 3 1.5 5h-5.8z"/></svg>
</file>

<file path="public/vercel.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1155 1000"><path d="m577.3 0 577.4 1000H0z" fill="#fff"/></svg>
</file>

<file path="public/window.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 2.5h13v10a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1zM0 1h16v11.5a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 0 12.5zm3.75 4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5M7 4.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m1.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5" fill="#666"/></svg>
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": ["node_modules"]
}
</file>

<file path="app/globals.css">
@import "tailwindcss";

/* Default theme variables (Cyberpunk) */
:root {
  /* Backgrounds */
  --bgPrimary: #0a0014;
  --bgSecondary: #1a0033;
  --bgCard: #1a0033;
  
  /* Text */
  --textPrimary: #ffffff;
  --textSecondary: #a0a0a0;
  
  /* Accents */
  --accent1: #00f0ff;
  --accent2: #ff00ff;
  --accent3: #8b00ff;
  --accent4: #0066ff;
  
  /* Borders & Effects */
  --borderColor: #00f0ff;
  --glowIntensity: 20px;
  --shadowIntensity: 0.6;
  
  /* Progress */
  --progressFill: #00f0ff;
}

@theme inline {
  --color-background: var(--bgPrimary);
  --color-foreground: var(--textPrimary);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

body {
  background: var(--bgPrimary);
  color: var(--textPrimary);
  font-family: Arial, Helvetica, sans-serif;
  transition: background-color 0.4s ease, color 0.4s ease;
}

/* Smooth transitions for theme changes */
* {
  transition-property: background-color, border-color, color, fill, stroke;
  transition-duration: 0.3s;
  transition-timing-function: ease;
}

/* Cyberpunk Animations */
@keyframes pulse-slow {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

@keyframes glow {
  0% {
    box-shadow: 0 0 5px rgba(0, 240, 255, var(--shadowIntensity));
  }
  100% {
    box-shadow: 0 0 var(--glowIntensity) rgba(0, 240, 255, var(--shadowIntensity));
  }
}

/* Bee Theme - Honey Fill Animation */
@keyframes honeyFill {
  0% { 
    transform: translateY(100%);
    opacity: 0;
  }
  100% { 
    transform: translateY(0%);
    opacity: 1;
  }
}

/* Bee Theme - Floating Pollen */
@keyframes floatPollen {
  0%, 100% { 
    transform: translateY(0px) translateX(0px);
    opacity: 0.6;
  }
  50% { 
    transform: translateY(-20px) translateX(10px);
    opacity: 1;
  }
}

/* Bee Theme - Gentle Glow Pulse */
@keyframes honeyGlow {
  0%, 100% {
    box-shadow: 0 0 10px rgba(255, 200, 61, 0.3);
  }
  50% {
    box-shadow: 0 0 20px rgba(255, 200, 61, 0.5);
  }
}

/* Hex grid pattern utility (for cyberpunk) */
.hex-grid {
  background-image: 
    linear-gradient(30deg, rgba(0, 240, 255, 0.13) 12%, transparent 12.5%, transparent 87%, rgba(0, 240, 255, 0.13) 87.5%),
    linear-gradient(150deg, rgba(0, 240, 255, 0.13) 12%, transparent 12.5%, transparent 87%, rgba(0, 240, 255, 0.13) 87.5%),
    linear-gradient(30deg, rgba(0, 240, 255, 0.13) 12%, transparent 12.5%, transparent 87%, rgba(0, 240, 255, 0.13) 87.5%),
    linear-gradient(150deg, rgba(0, 240, 255, 0.13) 12%, transparent 12.5%, transparent 87%, rgba(0, 240, 255, 0.13) 87.5%);
  background-size: 80px 140px;
  background-position: 0 0, 0 0, 40px 70px, 40px 70px;
}

/* Honeycomb pattern utility (for bee theme) */
.honeycomb-grid {
  background-image: 
    linear-gradient(30deg, rgba(255, 200, 61, 0.15) 12%, transparent 12.5%, transparent 87%, rgba(255, 200, 61, 0.15) 87.5%),
    linear-gradient(150deg, rgba(255, 200, 61, 0.15) 12%, transparent 12.5%, transparent 87%, rgba(255, 200, 61, 0.15) 87.5%),
    linear-gradient(30deg, rgba(255, 200, 61, 0.15) 12%, transparent 12.5%, transparent 87%, rgba(255, 200, 61, 0.15) 87.5%),
    linear-gradient(150deg, rgba(255, 200, 61, 0.15) 12%, transparent 12.5%, transparent 87%, rgba(255, 200, 61, 0.15) 87.5%);
  background-size: 80px 140px;
  background-position: 0 0, 0 0, 40px 70px, 40px 70px;
}

/* Shape utilities based on theme */
[data-shape="angular"] .themed-card {
  border-radius: 0.25rem;
  clip-path: polygon(8px 0, 100% 0, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0 100%, 0 8px);
}

[data-shape="rounded"] .themed-card {
  border-radius: 1rem;
}

[data-shape="hexagonal"] .themed-card {
  border-radius: 0.5rem;
  position: relative;
}

[data-shape="hexagonal"] .themed-card::before {
  content: '';
  position: absolute;
  inset: -2px;
  background: var(--borderColor);
  clip-path: polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%);
  z-index: -1;
  opacity: 0.3;
}
</file>

<file path="lib/supabaseClient.ts">
import { createClient } from '@supabase/supabase-js'

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
const supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!

// Validate that required environment variables are present
if (!supabaseUrl || !supabaseAnonKey) {
  throw new Error('Missing required Supabase environment variables')
}

/**
 * Browser-side Supabase client
 * Use this in client components and client-side code
 * Uses the public anon key with RLS policies
 */
export const supabaseBrowser = createClient(supabaseUrl, supabaseAnonKey, {
  auth: {
    persistSession: true,
    autoRefreshToken: true,
  },
})

/**
 * Server-side Supabase client with service role key
 * Use this ONLY in API routes and server components where you need to bypass RLS
 * NEVER expose this client to the browser
 */
export const supabaseAdmin = createClient(
  supabaseUrl, 
  supabaseServiceRoleKey || supabaseAnonKey, // Fallback to anon key if service role not available
  {
    auth: {
      persistSession: false,
      autoRefreshToken: false,
    },
  }
)

/**
 * Create a server-side client for server components
 * This uses the anon key and respects RLS policies
 * Use this in Server Components when you need user-context
 */
export const createServerClient = () => {
  return createClient(supabaseUrl, supabaseAnonKey, {
    auth: {
      persistSession: false,
      autoRefreshToken: false,
    },
  })
}
</file>

<file path="README.md">
# Apex Fitness Coach v2

Production rebuild of Apex Fitness Coach with Next.js, Supabase, and AI-powered adaptive fitness coaching.

## üéØ Overview

Apex Fitness Coach is a comprehensive AI-powered fitness application that creates fully personalized, adaptive fitness plans. Unlike traditional fitness apps, we take a holistic approach by managing **workouts, nutrition, sleep, and daily activity** - all powered by AI and adapted to your progress in real-time.

Upload photos of your current and goal physique, set your targets, and let our AI build a complete roadmap including:
- üí™ Personalized workout plans
- ü•ó Custom meal plans with macro calculations
- üö∂ Dynamic daily step goals
- üò¥ Sleep recommendations optimized for recovery
- üìä Progress tracking with automatic adjustments

## üöÄ Tech Stack

- **Framework:** Next.js 15 (App Router)
- **Language:** TypeScript
- **Styling:** Tailwind CSS
- **Database & Auth:** Supabase (PostgreSQL + Auth + Storage)
- **AI:** Claude API for workout, nutrition, and lifestyle planning
- **Image Analysis:** AI-powered physique analysis from photos

## üìÅ Project Structure
```
apex-fitness-coach-v2/
‚îú‚îÄ‚îÄ app/                      # Next.js App Router pages
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/           # User dashboard with all metrics
‚îÇ   ‚îú‚îÄ‚îÄ onboarding/          # User onboarding flow
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx           # Root layout with header
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx             # Landing page
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îî‚îÄ‚îÄ ui/                  # Reusable UI components
‚îÇ       ‚îú‚îÄ‚îÄ Button.tsx
‚îÇ       ‚îî‚îÄ‚îÄ Card.tsx
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îî‚îÄ‚îÄ supabaseClient.ts    # Supabase client configuration
‚îî‚îÄ‚îÄ public/                  # Static assets
```

## üõ†Ô∏è Setup Instructions

### Prerequisites

- Node.js 18+ installed
- npm or yarn package manager
- Supabase account (for database and auth)

### Installation

1. Clone the repository:
```bash
git clone https://github.com/YOUR-USERNAME/apex-fitness-coach-v2.git
cd apex-fitness-coach-v2
```

2. Install dependencies:
```bash
npm install
```

3. Create a `.env.local` file in the root directory:
```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
```

4. Run the development server:
```bash
npm run dev
```

5. Open [http://localhost:3000](http://localhost:3000) in your browser.

## ‚ú® Features

### Current Features (Phase 1)
- ‚úÖ Clean, modern UI with responsive design
- ‚úÖ Landing page with feature showcase
- ‚úÖ User onboarding flow (UI ready)
- ‚úÖ Dashboard layout (UI ready)
- ‚úÖ Reusable component library
- ‚úÖ Supabase integration setup

### Phase 2: Core AI Features (In Development)
- üîê User authentication (Supabase Auth)
- üì∏ Physique photo upload and AI analysis
- ü§ñ AI-powered personalized workout plan generation
- ü•ó AI-generated meal plans with macro calculations
- üìä Macro tracking and nutritional guidance
- üö∂ Dynamic daily step goal recommendations
- üò¥ Sleep duration recommendations based on goals and recovery needs
- üìÖ Adaptive timeline that adjusts based on progress

### Phase 3: Advanced Features (Planned)
- ‚åö Fitness watch integration (Apple Watch, Fitbit, Garmin, etc.)
  - Automatic step tracking
  - Sleep tracking sync
  - Heart rate monitoring
  - Workout session auto-detection
- üìà Advanced progress analytics and visualizations
- üçΩÔ∏è Meal logging and tracking
- üíß Hydration tracking and reminders
- üéØ Goal milestone celebrations
- üì± Mobile app (React Native)
- üîî Smart notifications and reminders
- üë• Social features and accountability partners

## üé® Core Philosophy

### Holistic Approach
We believe fitness isn't just about workouts - it's about the complete picture:
- **Training:** Personalized workouts that progress with you
- **Nutrition:** Take the guesswork out of meal planning with AI-generated meals
- **Recovery:** Optimized sleep recommendations for your goals
- **Activity:** Dynamic step goals that adapt to your progress
- **Automation:** Sync with fitness watches to eliminate manual tracking

### AI-Powered Adaptation
Unlike static programs, Apex Fitness Coach continuously adapts:
- Workouts adjust based on performance and feedback
- Meal plans update based on progress toward goals
- Step goals dynamically change as fitness improves
- Sleep recommendations factor in training intensity and recovery

### Remove the Guesswork
- No more wondering if your macros are right
- No more generic "10,000 steps a day" advice
- No more trial-and-error with meal planning
- Let AI do the complex calculations and adjustments

## üéØ Feature Deep Dive

### AI Workout Planning
- Analyzes current and goal physique photos
- Creates progressive workout programs
- Adjusts difficulty based on feedback and performance
- Includes exercise demonstrations and form tips

### AI Nutrition Planning
- **Macro Calculation:** AI determines optimal protein, carbs, and fats
- **Meal Generation:** Complete meal plans generated to hit your macros
- **Flexibility:** Dietary preferences and restrictions respected
- **No Guesswork:** Exact portions and ingredients provided

### Dynamic Activity Goals
- Daily step recommendations that adapt to your:
  - Current fitness level
  - Weight loss/gain goals
  - Training schedule (rest days vs. workout days)
  - Recent activity patterns

### Sleep Optimization
- Personalized sleep duration recommendations based on:
  - Training intensity
  - Recovery needs
  - Goal timeline
  - Current sleep patterns (from watch data)

### Fitness Watch Integration (Future)
- **Automatic Data Sync:** Steps, sleep, heart rate, workouts
- **Seamless Experience:** No manual entry required
- **Better AI Decisions:** More data = more accurate recommendations
- **Supported Devices:** Apple Watch, Fitbit, Garmin, and more

## üìä Dashboard Features

The dashboard will display:
- Today's workout plan
- Meal plan for the day with macro breakdown
- Daily step goal and current progress
- Sleep recommendation and last night's sleep quality
- Progress photos timeline
- Body composition changes
- Upcoming milestones

## üõ†Ô∏è Development

### Available Scripts

- `npm run dev` - Start development server
- `npm run build` - Build for production
- `npm start` - Start production server
- `npm run lint` - Run ESLint

### Code Style

- TypeScript for type safety
- Functional React components
- Tailwind utility classes for styling
- Clean, readable code with comments

## üó∫Ô∏è Roadmap

**Q1 2026:**
- User authentication and onboarding
- Photo upload and AI physique analysis
- AI workout plan generation
- Basic progress tracking

**Q2 2026:**
- AI nutrition and meal planning
- Macro calculations and tracking
- Dynamic step goal recommendations
- Sleep optimization features

**Q3 2026:**
- Fitness watch integrations (Apple Watch, Fitbit, Garmin)
- Automatic data syncing
- Advanced progress analytics
- Enhanced dashboard visualizations

**Q4 2026:**
- Mobile app development (React Native)
- Social features and community
- Premium tier features
- Payment integration and monetization

## üìÑ License

**This is a proprietary commercial application.**  
All rights reserved. This code is confidential and intended only for authorized team members.

Unauthorized copying, distribution, or use of this software is strictly prohibited.

## üîó Links

- [Next.js Documentation](https://nextjs.org/docs)
- [Supabase Documentation](https://supabase.com/docs)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [Anthropic Claude API](https://www.anthropic.com/api)

---

**Built with ‚ù§Ô∏è for commercial launch**
</file>

<file path="app/layout.tsx">
import type { Metadata } from 'next'
import { Inter } from 'next/font/google'
import './globals.css'
import { ThemeProvider } from '@/components/ThemeProvider'
import { AuthProvider } from '@/components/AuthProvider'

const inter = Inter({ subsets: ['latin'] })

export const metadata: Metadata = {
  title: 'Apex Fitness Coach',
  description: 'AI-powered adaptive fitness planning',
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body className={inter.className}>
        <ThemeProvider>
          <AuthProvider>
            {children}
          </AuthProvider>
        </ThemeProvider>
      </body>
    </html>
  )
}
</file>

<file path="package.json">
{
  "name": "apex-fitness-coach-v2",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "@anthropic-ai/sdk": "^0.71.2",
    "@supabase/supabase-js": "^2.87.1",
    "dotenv": "^17.2.3",
    "next": "16.0.10",
    "react": "19.2.1",
    "react-dom": "19.2.1"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "eslint": "^9",
    "eslint-config-next": "16.0.10",
    "tailwindcss": "^4",
    "typescript": "^5"
  }
}
</file>

<file path="app/dashboard/page.tsx">
'use client'

import { useEffect, useState } from 'react'
import { useRouter } from 'next/navigation'
import Link from 'next/link'
import { useAuth } from '@/components/AuthProvider'
import { useTheme } from '@/components/ThemeProvider'
import { ThemeSwitcher } from '@/components/ThemeSwitcher'
import { supabaseBrowser } from '@/lib/supabaseClient'

// XP System - RPG-style exponential curve
function getXPForLevel(level: number): number {
  return Math.floor(100 * Math.pow(level, 1.5))
}

function getXPProgress(totalXP: number, currentLevel: number) {
  // Calculate total XP needed for current level
  let totalNeeded = 0
  for (let i = 1; i < currentLevel; i++) {
    totalNeeded += getXPForLevel(i)
  }
  
  const xpIntoCurrentLevel = totalXP - totalNeeded
  const xpNeededForNextLevel = getXPForLevel(currentLevel)
  const percentToNext = Math.floor((xpIntoCurrentLevel / xpNeededForNextLevel) * 100)
  
  return {
    current: xpIntoCurrentLevel,
    needed: xpNeededForNextLevel,
    percent: percentToNext,
    remaining: xpNeededForNextLevel - xpIntoCurrentLevel
  }
}

export default function DashboardPage() {
  const { user, loading: authLoading, signOut } = useAuth()
  const { themeConfig } = useTheme()
  const router = useRouter()

  const [profile, setProfile] = useState<any>(null)
  const [activePlan, setActivePlan] = useState<any>(null)
  const [userStats, setUserStats] = useState<any>(null)
  const [recentBadges, setRecentBadges] = useState<any[]>([])
  const [currentWeekProgress, setCurrentWeekProgress] = useState<any>(null)
  
  const [loadingProfile, setLoadingProfile] = useState(true)
  const [loadingPlan, setLoadingPlan] = useState(true)
  const [loadingStats, setLoadingStats] = useState(true)
  const [generatingPlan, setGeneratingPlan] = useState(false)
  const [initializingStats, setInitializingStats] = useState(false)
  const [error, setError] = useState<string | null>(null)
  const [latestPlan, setLatestPlan] = useState<any>(null)

  // Redirect if not logged in
  useEffect(() => {
    if (!authLoading && !user) {
      router.push('/login')
    }
  }, [user, authLoading, router])

  // Fetch user profile
  useEffect(() => {
    async function fetchProfile() {
      if (!user) return

      try {
        const { data, error } = await supabaseBrowser
          .from('user_profiles')
          .select('*')
          .eq('user_id', user.id)
          .single()

        if (error && error.code !== 'PGRST116') {
          console.error('Error fetching profile:', error)
          return
        }
        setProfile(data)
      } finally {
        setLoadingProfile(false)
      }
    }

    fetchProfile()
  }, [user])

  // Fetch active plan
  useEffect(() => {
    async function fetchPlan() {
      if (!user) return

      try {
        const { data, error } = await supabaseBrowser
          .from('user_plans')
          .select('*')
          .eq('user_id', user.id)
          .eq('status', 'active')
          .single()

        if (error && error.code !== 'PGRST116') {
          throw error
        }
        setActivePlan(data)
      } catch (err: any) {
        console.error('Error fetching plan:', err)
      } finally {
        setLoadingPlan(false)
      }
    }

    fetchPlan()
  }, [user])

  // Fetch user stats, badges, and progress
  useEffect(() => {
    async function fetchGameData() {
      if (!user) return

      try {
        // Fetch user stats
        const { data: stats } = await supabaseBrowser
          .from('user_stats')
          .select('*')
          .eq('user_id', user.id)
          .single()

        setUserStats(stats)

        // Fetch recent badges (last 3)
        const { data: badges } = await supabaseBrowser
          .from('user_badges')
          .select('*')
          .eq('user_id', user.id)
          .order('unlocked_at', { ascending: false })
          .limit(3)

        setRecentBadges(badges || [])

        // Fetch current week progress
        if (stats) {
          const { data: weekProgress } = await supabaseBrowser
            .from('user_progress')
            .select('*')
            .eq('user_id', user.id)
            .eq('week_number', stats.current_week)
            .single()

          setCurrentWeekProgress(weekProgress)
        }

      } catch (err: any) {
        console.error('Error fetching game data:', err)
      } finally {
        setLoadingStats(false)
      }
    }

    fetchGameData()
  }, [user])

  // Initialize stats if they don't exist
  const handleInitializeStats = async () => {
    setInitializingStats(true)
    setError(null)

    try {
      const { data: { session } } = await supabaseBrowser.auth.getSession()
      
      if (!session) {
        setError('Please log in again')
        return
      }

      const response = await fetch('/api/initialize-stats', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${session.access_token}`,
        },
      })

      const result = await response.json()

      if (!response.ok) {
        throw new Error(result.error || 'Failed to initialize stats')
      }

      // Refresh stats
      setUserStats(result.stats)
      if (result.firstBadge) {
        setRecentBadges([result.firstBadge])
      }
      if (result.weekProgress) {
        setCurrentWeekProgress(result.weekProgress)
      }

    } catch (err: any) {
      console.error('Initialization error:', err)
      setError(err.message || 'Failed to initialize stats')
    } finally {
      setInitializingStats(false)
    }
  }

  // Generate plan - FIXED VERSION
  const handleGeneratePlan = async () => {
    setGeneratingPlan(true)
    setError(null)

    try {
      console.log('ü§ñ Starting plan generation...')
      
      const { data: { session }, error: sessionError } = await supabaseBrowser.auth.getSession()
      
      if (sessionError || !session) {
        setError('Please log in again to generate a plan')
        setGeneratingPlan(false)
        return
      }

      console.log('‚úÖ Session valid')

      // Check we have profile data
      if (!profile) {
        setError('Please complete your profile first')
        setGeneratingPlan(false)
        return
      }

      console.log('‚úÖ Profile data ready, calling API...')

      // FIXED: Send profile data in the request body
      const response = await fetch('/api/generate-plan', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${session.access_token}`,
        },
        body: JSON.stringify({
          profile: profile,        // ‚Üê THE FIX IS HERE
          currentPhotos: [],
          goalPhotos: []
        })
      })

      console.log('üì° Response status:', response.status)

      // Check if response is JSON before parsing
      const contentType = response.headers.get('content-type')
      if (!contentType || !contentType.includes('application/json')) {
        const textResponse = await response.text()
        console.error('Non-JSON response:', textResponse)
        throw new Error('Server error - check console for details')
      }

      const result = await response.json()

      if (!response.ok) {
        throw new Error(result.error || result.details || 'Failed to generate plan')
      }

      if (!result.success) {
        throw new Error(result.error || 'Failed to generate plan')
      }

      console.log('‚úÖ Plan generated successfully!')
      
      // Refresh the active plan from database
      const { data: savedPlan } = await supabaseBrowser
        .from('user_plans')
        .select('*')
        .eq('user_id', user?.id)
        .eq('status', 'active')
        .order('created_at', { ascending: false })
        .limit(1)
        .single()
      
      if (savedPlan) {
        setActivePlan(savedPlan)
      }

      alert('‚úÖ Plan generated successfully! Check the stats above.')

    } catch (err: any) {
      console.error('‚ùå Plan generation error:', err)
      setError(err.message || 'Failed to generate plan')
      alert('‚ùå Error: ' + err.message)
    } finally {
      setGeneratingPlan(false)
    }
  }

  // Show loading
  if (authLoading) {
    return (
      <div 
        className="min-h-screen flex items-center justify-center"
        style={{ background: 'var(--bgPrimary)' }}
      >
        <div style={{ color: 'var(--textPrimary)' }}>
          Loading...
        </div>
      </div>
    )
  }

  if (!user) {
    return null
  }

  return (
    <div 
      className="min-h-screen p-4 md:p-8 transition-all duration-500"
      style={{ background: 'var(--bgPrimary)' }}
    >
      <div className="max-w-7xl mx-auto space-y-6">
        
        {/* Header */}
        <div className="flex justify-between items-start">
          <div>
            <h1 
              className="text-3xl md:text-4xl font-bold mb-2"
              style={{
                backgroundImage: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                backgroundClip: 'text',
              }}
            >
              {profile?.full_name ? `Welcome, ${profile.full_name}!` : 'Welcome to Your Dashboard'}
            </h1>
            <p style={{ color: 'var(--textSecondary)' }}>
              {user.email}
            </p>
          </div>

          <button
            onClick={signOut}
            className="px-4 md:px-6 py-2 md:py-3 rounded-lg font-bold transition-all duration-300 hover:opacity-80"
            style={{
              backgroundImage: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
              color: '#FFFFFF',
            }}
          >
            Sign Out
          </button>
        </div>

        {/* XP & Level Display */}
        {!loadingStats && userStats && (
          <div
            className="themed-card p-6 border-2"
            style={{
              backgroundColor: 'var(--bgCard)',
              borderColor: 'var(--borderColor)',
            }}
          >
            <div className="flex items-center justify-between mb-3">
              <div>
                <div className="text-3xl font-black" style={{ color: 'var(--textPrimary)' }}>
                  Level {userStats.level}
                </div>
                <div className="text-sm" style={{ color: 'var(--textSecondary)' }}>
                  {getXPProgress(userStats.total_xp, userStats.level).remaining} XP to Level {userStats.level + 1}
                </div>
              </div>
              <div className="text-right">
                <div className="text-sm font-semibold" style={{ color: 'var(--accent2)' }}>
                  Total XP
                </div>
                <div className="text-2xl font-bold" style={{ color: 'var(--accent1)' }}>
                  {userStats.total_xp.toLocaleString()}
                </div>
              </div>
            </div>
            
            {/* XP Progress Bar */}
            <div className="relative h-8 rounded-full overflow-hidden" style={{ backgroundColor: 'var(--bgSecondary)' }}>
              <div 
                className="absolute inset-0 transition-all duration-500"
                style={{
                  width: `${getXPProgress(userStats.total_xp, userStats.level).percent}%`,
                  backgroundImage: `linear-gradient(90deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                }}
              />
              <div className="absolute inset-0 flex items-center justify-center">
                <span className="text-sm font-bold" style={{ 
                  color: getXPProgress(userStats.total_xp, userStats.level).percent > 50 ? '#FFFFFF' : 'var(--textPrimary)',
                  textShadow: '0 1px 2px rgba(0,0,0,0.3)'
                }}>
                  {getXPProgress(userStats.total_xp, userStats.level).current.toLocaleString()} / {getXPProgress(userStats.total_xp, userStats.level).needed.toLocaleString()} XP
                </span>
              </div>
            </div>
            
            <div className="text-xs text-center mt-2" style={{ color: 'var(--textSecondary)' }}>
              {getXPProgress(userStats.total_xp, userStats.level).percent}% to next level
            </div>
          </div>
        )}

        {/* X% Better Hero Metric */}
        {!loadingStats && userStats && currentWeekProgress && (
          <div
            className="themed-card p-8 md:p-12 border-2 text-center relative overflow-hidden"
            style={{
              backgroundColor: 'var(--bgCard)',
              borderColor: 'var(--accent1)',
            }}
          >
            <div className="text-sm font-semibold mb-2" style={{ color: 'var(--textSecondary)' }}>
              This Week's Progress
            </div>
            <div 
              className="text-6xl md:text-8xl font-black mb-4"
              style={{
                backgroundImage: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2}, ${themeConfig.colors.accent3})`,
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                backgroundClip: 'text',
                filter: 'drop-shadow(0 0 20px rgba(255,255,255,0.3))',
              }}
            >
              {currentWeekProgress.x_percent_better || 0}%
            </div>
            <div className="text-xl md:text-2xl font-bold" style={{ color: 'var(--textPrimary)' }}>
              Better Than Last Week!
            </div>
            <div className="mt-4 text-sm" style={{ color: 'var(--textSecondary)' }}>
              Keep showing up - every workout counts! üí™
            </div>
          </div>
        )}

        {/* Initialize Stats Button (if no stats) */}
        {!loadingStats && !userStats && activePlan && (
          <div
            className="themed-card p-8 border-2 text-center"
            style={{
              backgroundColor: 'var(--bgCard)',
              borderColor: 'var(--borderColor)',
            }}
          >
            <div className="text-4xl mb-4">üéÆ</div>
            <h3 className="text-2xl font-bold mb-4" style={{ color: 'var(--textPrimary)' }}>
              Ready to Start Tracking?
            </h3>
            <p className="mb-6" style={{ color: 'var(--textSecondary)' }}>
              Initialize your progress tracking and earn your first badge!
            </p>
            <button
              onClick={handleInitializeStats}
              disabled={initializingStats}
              className="px-8 py-4 rounded-lg font-bold text-lg transition-all duration-300 hover:scale-105 disabled:opacity-50"
              style={{
                backgroundImage: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                color: '#FFFFFF',
              }}
            >
              {initializingStats ? 'Starting...' : 'Start Tracking Progress üöÄ'}
            </button>
          </div>
        )}

        {/* Badges Section */}
        {!loadingStats && recentBadges.length > 0 && (
          <div
            className="themed-card p-6 border-2"
            style={{
              backgroundColor: 'var(--bgCard)',
              borderColor: 'var(--borderColor)',
            }}
          >
            <h3 className="text-xl font-bold mb-4 flex items-center gap-2" style={{ color: 'var(--textPrimary)' }}>
              <span>üèÜ</span> Recent Badges
            </h3>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
              {recentBadges.map((badge) => (
                <div
                  key={badge.id}
                  className="p-4 rounded-lg border-2 text-center transition-all duration-300 hover:scale-105"
                  style={{
                    backgroundColor: 'var(--bgSecondary)',
                    borderColor: 'var(--accent1)',
                  }}
                >
                  <div className="text-4xl mb-2">üèÖ</div>
                  <div className="font-bold mb-1" style={{ color: 'var(--accent1)' }}>
                    {badge.badge_name}
                  </div>
                  <div className="text-sm" style={{ color: 'var(--textSecondary)' }}>
                    {badge.badge_description}
                  </div>
                  <div className="text-xs mt-2" style={{ color: 'var(--accent2)' }}>
                    +{badge.xp_earned} XP
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Generate Plan Section OR Onboarding Prompt */}
        {!loadingProfile && (
          <>
            {profile ? (
              <div
                className="themed-card p-6 md:p-8 border-2"
                style={{
                  backgroundColor: 'var(--bgCard)',
                  borderColor: 'var(--borderColor)',
                }}
              >
                <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                  <div>
                    <h3 
                      className="text-2xl font-bold mb-2"
                      style={{ color: 'var(--accent1)' }}
                    >
                      {activePlan ? 'üéØ Your Fitness Plan' : 'üöÄ Ready to Start?'}
                    </h3>
                    <p style={{ color: 'var(--textSecondary)' }}>
                      {activePlan 
                        ? `Plan created ${new Date(activePlan.created_at).toLocaleDateString()}`
                        : 'Generate your personalized AI-powered fitness plan'
                      }
                    </p>
                  </div>

                  <button
                    onClick={handleGeneratePlan}
                    disabled={generatingPlan}
                    className="px-6 py-3 rounded-lg font-bold transition-all duration-300 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap"
                    style={{
                      backgroundImage: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                      color: '#FFFFFF',
                    }}
                  >
                    {generatingPlan ? (
                      <span className="flex items-center gap-2">
                        <span className="animate-spin">‚öôÔ∏è</span>
                        Generating...
                      </span>
                    ) : activePlan ? (
                      'Regenerate Plan'
                    ) : (
                      'Generate My Plan'
                    )}
                  </button>

                  {activePlan && (
                    <button
                      onClick={() => router.push('/plan')}
                      className="px-6 py-3 rounded-lg font-bold transition-all duration-300 hover:opacity-80"
                      style={{
                        background: `linear-gradient(135deg, ${themeConfig.colors.accent2}, ${themeConfig.colors.accent3})`,
                        color: '#FFFFFF',
                      }}
                    >
                      üìã View My Plan
                    </button>
                  )}
                </div>

                {error && (
                  <div 
                    className="p-4 rounded-lg border-2 mb-4"
                    style={{
                      backgroundColor: 'rgba(239, 68, 68, 0.1)',
                      borderColor: '#EF4444',
                      color: '#EF4444',
                    }}
                  >
                    {error}
                  </div>
                )}

                {loadingPlan ? (
                  <div style={{ color: 'var(--textSecondary)' }}>
                    Loading plan...
                  </div>
                ) : activePlan ? (
                  <div className="space-y-6">
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                      <div 
                        className="p-4 rounded-lg"
                        style={{ backgroundColor: 'var(--bgSecondary)' }}
                      >
                        <div className="text-sm" style={{ color: 'var(--textSecondary)' }}>
                          Time to Goal
                        </div>
                        <div className="text-2xl font-bold" style={{ color: 'var(--accent1)' }}>
                          {activePlan.plan_json.time_to_goal?.estimate_weeks_range?.min || 'N/A'}-
                          {activePlan.plan_json.time_to_goal?.estimate_weeks_range?.max || 'N/A'} weeks
                        </div>
                      </div>

                      <div 
                        className="p-4 rounded-lg"
                        style={{ backgroundColor: 'var(--bgSecondary)' }}
                      >
                        <div className="text-sm" style={{ color: 'var(--textSecondary)' }}>
                          Workouts/Week
                        </div>
                        <div className="text-2xl font-bold" style={{ color: 'var(--accent2)' }}>
                          {activePlan.plan_json.weekly_plan?.days_per_week || 'N/A'} days
                        </div>
                      </div>

                      <div 
                        className="p-4 rounded-lg"
                        style={{ backgroundColor: 'var(--bgSecondary)' }}
                      >
                        <div className="text-sm" style={{ color: 'var(--textSecondary)' }}>
                          Daily Calories
                        </div>
                        <div className="text-2xl font-bold" style={{ color: 'var(--accent3)' }}>
                          {activePlan.plan_json.nutrition?.calorie_target_range?.min || 'N/A'}-
                          {activePlan.plan_json.nutrition?.calorie_target_range?.max || 'N/A'}
                        </div>
                      </div>

                      <div 
                        className="p-4 rounded-lg"
                        style={{ backgroundColor: 'var(--bgSecondary)' }}
                      >
                        <div className="text-sm" style={{ color: 'var(--textSecondary)' }}>
                          Daily Steps
                        </div>
                        <div className="text-2xl font-bold" style={{ color: 'var(--accent4)' }}>
                          {activePlan.plan_json.recovery_and_steps?.steps_target_range?.min || 'N/A'}-
                          {activePlan.plan_json.recovery_and_steps?.steps_target_range?.max || 'N/A'}
                        </div>
                      </div>
                    </div>

                    {activePlan.plan_json.disclaimer && (
                      <div 
                        className="p-4 rounded-lg border"
                        style={{
                          backgroundColor: 'var(--bgSecondary)',
                          borderColor: 'var(--borderColor)',
                          color: 'var(--textSecondary)',
                        }}
                      >
                        <p className="text-sm">{activePlan.plan_json.disclaimer}</p>
                      </div>
                    )}

                    <div 
                      className="p-6 rounded-lg border-2"
                      style={{
                        backgroundColor: 'var(--bgSecondary)',
                        borderColor: 'var(--accent1)',
                      }}
                    >
                      <h4 className="font-bold mb-2" style={{ color: 'var(--accent1)' }}>
                        üì± Full Plan Viewer Coming Soon
                      </h4>
                      <p style={{ color: 'var(--textSecondary)' }}>
                        Your complete plan has been generated! We're building the full interface to display workouts, meals, milestones, and more. For now, you can see your quick stats above.
                      </p>
                    </div>
                  </div>
                ) : (
                  <div style={{ color: 'var(--textSecondary)' }}>
                    <p className="mb-2">Click "Generate My Plan" to create your personalized fitness plan.</p>
                    <p className="text-sm">This uses AI to analyze your goals and create a complete workout, nutrition, and recovery plan.</p>
                  </div>
                )}
              </div>
            ) : (
              <div
                className="themed-card p-12 border-2 text-center"
                style={{
                  backgroundColor: 'var(--bgCard)',
                  borderColor: 'var(--borderColor)',
                }}
              >
                <div className="text-6xl mb-6">üëã</div>
                <h2 
                  className="text-3xl font-bold mb-4"
                  style={{
                    backgroundImage: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                    WebkitBackgroundClip: 'text',
                    WebkitTextFillColor: 'transparent',
                    backgroundClip: 'text',
                  }}
                >
                  Let's Get You Started!
                </h2>
                <p className="text-lg mb-8" style={{ color: 'var(--textSecondary)' }}>
                  Complete your profile so we can build your personalized fitness plan
                </p>
                <Link href="/onboarding">
                  <button
                    className="px-8 py-4 rounded-lg font-bold text-lg transition-all duration-300 hover:scale-105"
                    style={{
                      backgroundImage: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                      color: '#FFFFFF',
                    }}
                  >
                    Complete Your Profile ‚Üí
                  </button>
                </Link>
                <p className="text-sm mt-4" style={{ color: 'var(--textSecondary)' }}>
                  Takes less than 2 minutes ‚Ä¢ 4 simple questions
                </p>
              </div>
            )}
          </>
        )}

        {/* Theme Switcher */}
        <div className="space-y-4">
          <h2 
            className="text-2xl font-bold"
            style={{ color: 'var(--textPrimary)' }}
          >
            Choose Your Theme
          </h2>
          <ThemeSwitcher />
        </div>

        {/* Profile Summary */}
        {!loadingProfile && profile && (
          <div
            className="themed-card p-6 md:p-8 border-2"
            style={{
              backgroundColor: 'var(--bgCard)',
              borderColor: 'var(--borderColor)',
            }}
          >
            <div className="flex justify-between items-center mb-4">
              <h3 
                className="text-xl font-bold"
                style={{ color: 'var(--textPrimary)' }}
              >
                Your Profile
              </h3>
              <div className="flex gap-2">
                <Link href="/photos/upload">
                  <button
                    className="px-4 py-2 rounded-lg font-semibold text-sm border-2 transition-all duration-300 hover:scale-105"
                    style={{
                      borderColor: 'var(--borderColor)',
                      color: 'var(--textPrimary)',
                      backgroundColor: 'var(--bgSecondary)',
                    }}
                  >
                    üì∏ Edit Photos
                  </button>
                </Link>
                <Link href="/onboarding">
                  <button
                    className="px-4 py-2 rounded-lg font-semibold text-sm border-2 transition-all duration-300 hover:scale-105"
                    style={{
                      borderColor: 'var(--borderColor)',
                      color: 'var(--textPrimary)',
                      backgroundColor: 'var(--bgSecondary)',
                    }}
                  >
                    ‚úèÔ∏è Edit Profile
                  </button>
                </Link>
              </div>
            </div>
            <div className="grid md:grid-cols-2 gap-4" style={{ color: 'var(--textSecondary)' }}>
              <div>
                <p><strong style={{ color: 'var(--textPrimary)' }}>Age:</strong> {profile.age}</p>
                <p><strong style={{ color: 'var(--textPrimary)' }}>Gender:</strong> {profile.gender}</p>
                <p><strong style={{ color: 'var(--textPrimary)' }}>Experience:</strong> {profile.experience_level}</p>
              </div>
              <div>
                <p><strong style={{ color: 'var(--textPrimary)' }}>Goal:</strong> {profile.fitness_goal}</p>
                <p><strong style={{ color: 'var(--textPrimary)' }}>Frequency:</strong> {profile.workout_frequency}</p>
                <p><strong style={{ color: 'var(--textPrimary)' }}>Location:</strong> {profile.training_location}</p>
              </div>
            </div>

            {profile.training_location === 'commercial' && (
              <div className="mt-4">
                <p style={{ color: 'var(--textSecondary)' }}>
                  <strong style={{ color: 'var(--textPrimary)' }}>Gym:</strong>{' '}
                  {profile.gym_chain || profile.gym_custom_name || 'Not specified'}
                </p>
              </div>
            )}

            {profile.available_equipment && profile.available_equipment.length > 0 && (
              <div className="mt-4">
                <p className="mb-2" style={{ color: 'var(--textPrimary)' }}>
                  <strong>Available Equipment:</strong>
                </p>
                <div className="flex flex-wrap gap-2">
                  {profile.available_equipment.map((item: string, idx: number) => (
                    <span 
                      key={idx}
                      className="px-3 py-1 rounded-full text-sm font-semibold"
                      style={{
                        backgroundColor: 'var(--accent1)',
                        color: '#FFFFFF',
                      }}
                    >
                      {item}
                    </span>
                  ))}
                </div>
              </div>
            )}
          </div>
        )}

      </div>
    </div>
  )
}
</file>

<file path="app/onboarding/page.tsx">
'use client'

import { useState, useEffect } from 'react'
import { useRouter } from 'next/navigation'
import { useAuth } from '@/components/AuthProvider'
import { useTheme } from '@/components/ThemeProvider'
import { supabaseBrowser } from '@/lib/supabaseClient'

type OnboardingStep = 1 | 2 | 3 | 4

interface OnboardingData {
  full_name: string
  age: string
  gender: string
  fitness_goal: string
  experience_level: string
  training_location: string
  gym_chain: string
  gym_custom_name: string
  available_equipment: string[]
  workout_frequency: string
}

export default function OnboardingPage() {
  const router = useRouter()
  const { user } = useAuth()
  const { themeConfig } = useTheme()
  
  const [currentStep, setCurrentStep] = useState<OnboardingStep>(1)
  const [loading, setLoading] = useState(false)
  const [initialLoading, setInitialLoading] = useState(true)
  const [error, setError] = useState<string | null>(null)
  const [isEditing, setIsEditing] = useState(false)
  
  const [formData, setFormData] = useState<OnboardingData>({
    full_name: '',
    age: '',
    gender: '',
    fitness_goal: '',
    experience_level: '',
    training_location: '',
    gym_chain: '',
    gym_custom_name: '',
    available_equipment: [],
    workout_frequency: '',
  })

  // Vitals state
  const [heightFeet, setHeightFeet] = useState('')
  const [heightInches, setHeightInches] = useState('')
  const [currentWeight, setCurrentWeight] = useState('')
  const [goalWeight, setGoalWeight] = useState('')
  const [weightUnit, setWeightUnit] = useState<'lbs' | 'kg'>('lbs')

  // Load existing profile data if editing
  useEffect(() => {
    loadExistingProfile()
  }, [user])

  async function loadExistingProfile() {
    if (!user) return

    try {
      const { data: profile, error } = await supabaseBrowser
        .from('user_profiles')
        .select('*')
        .eq('user_id', user.id)
        .single()

      if (profile) {
        setIsEditing(true)
        
        setFormData({
          full_name: profile.full_name || '',
          age: profile.age?.toString() || '',
          gender: profile.gender || '',
          fitness_goal: profile.fitness_goal || '',
          experience_level: profile.experience_level || '',
          training_location: profile.training_location || '',
          gym_chain: profile.gym_chain || '',
          gym_custom_name: profile.gym_custom_name || '',
          available_equipment: profile.available_equipment || [],
          workout_frequency: profile.workout_frequency || '',
        })

        setHeightFeet(profile.height_feet?.toString() || '')
        setHeightInches(profile.height_inches?.toString() || '')
        setCurrentWeight(profile.current_weight?.toString() || '')
        setGoalWeight(profile.goal_weight?.toString() || '')
        setWeightUnit(profile.weight_unit || 'lbs')
      }
    } catch (err) {
      console.error('Error loading profile:', err)
    } finally {
      setInitialLoading(false)
    }
  }

  const handleInputChange = (field: keyof OnboardingData, value: string) => {
    setFormData(prev => ({ ...prev, [field]: value }))
  }

  const handleEquipmentToggle = (equipment: string) => {
    setFormData(prev => ({
      ...prev,
      available_equipment: prev.available_equipment.includes(equipment)
        ? prev.available_equipment.filter(e => e !== equipment)
        : [...prev.available_equipment, equipment]
    }))
  }

  const handleNext = () => {
    setError(null)
    
    if (currentStep === 1) {
      if (!formData.full_name || !formData.age || !formData.gender) {
        setError("Come on, don't leave us hanging! Fill in all the fields üòä")
        return
      }
      if (parseInt(formData.age) < 13 || parseInt(formData.age) > 120) {
        setError('That age seems... off. Give us a real number!')
        return
      }

      if (!heightFeet || parseInt(heightFeet) < 4 || parseInt(heightFeet) > 7) {
        setError('Please enter a valid height between 4-7 feet')
        return
      }
      
      const inches = parseInt(heightInches || '0')
      if (inches < 0 || inches >= 12) {
        setError('Inches must be between 0-11')
        return
      }
      
      if (!currentWeight || parseFloat(currentWeight) < 50) {
        setError('Please enter a valid weight (minimum 50)')
        return
      }
      
      if (goalWeight && parseFloat(goalWeight) < 50) {
        setError('Goal weight must be at least 50')
        return
      }
    }
    
    if (currentStep === 2 && !formData.fitness_goal) {
      setError('Pick one! What are we working towards? üí™')
      return
    }
    
    if (currentStep === 3 && !formData.experience_level) {
      setError('No judgment! Where are you at right now?')
      return
    }
    
    if (currentStep < 4) {
      setCurrentStep((currentStep + 1) as OnboardingStep)
    }
  }

  const handleBack = () => {
    if (currentStep > 1) {
      setCurrentStep((currentStep - 1) as OnboardingStep)
      setError(null)
    }
  }

  const handleSubmit = async () => {
    setLoading(true)
    setError(null)

    if (!formData.workout_frequency) {
      setError('How many days can you commit? Pick one!')
      setLoading(false)
      return
    }

    if (!formData.training_location) {
      setError('Where will you be training? Pick one!')
      setLoading(false)
      return
    }

    if (formData.training_location === 'commercial' && !formData.gym_chain && !formData.gym_custom_name) {
      setError('Tell us which gym you go to!')
      setLoading(false)
      return
    }

    if (formData.training_location !== 'commercial' && formData.available_equipment.length === 0) {
      setError('What equipment do you have access to? Pick at least one!')
      setLoading(false)
      return
    }

    try {
      const heightCm = Math.round(
        (parseInt(heightFeet) * 30.48) + (parseInt(heightInches || '0') * 2.54)
      )

      const profileData = {
        user_id: user?.id,
        full_name: formData.full_name,
        age: parseInt(formData.age),
        gender: formData.gender,
        
        height_feet: parseInt(heightFeet),
        height_inches: parseInt(heightInches || '0'),
        height_cm: heightCm,
        current_weight: parseFloat(currentWeight),
        goal_weight: goalWeight ? parseFloat(goalWeight) : null,
        weight_unit: weightUnit,
        
        fitness_goal: formData.fitness_goal,
        experience_level: formData.experience_level,
        
        training_location: formData.training_location,
        gym_chain: formData.training_location === 'commercial' ? formData.gym_chain : null,
        gym_custom_name: formData.training_location === 'commercial' ? formData.gym_custom_name : null,
        
        available_equipment: formData.training_location !== 'commercial' ? formData.available_equipment : [],
        
        workout_frequency: formData.workout_frequency,
        has_completed_onboarding: true,
        updated_at: new Date().toISOString()
      }

      const { error: dbError } = await supabaseBrowser
        .from('user_profiles')
        .upsert(profileData, {
          onConflict: 'user_id'
        })

      if (dbError) {
        console.error('Database error:', dbError)
        throw dbError
      }

      router.push('/dashboard')
    } catch (err: any) {
      console.error('Submit error:', err)
      setError(err.message || 'Failed to save profile')
    } finally {
      setLoading(false)
    }
  }

  // COMPREHENSIVE EQUIPMENT LIST - 31 items
  const equipmentOptions = [
    // Free Weights
    { name: 'Dumbbells', emoji: 'üí™', category: 'Free Weights' },
    { name: 'Barbell', emoji: 'üèãÔ∏è', category: 'Free Weights' },
    { name: 'Kettlebells', emoji: '‚ö´', category: 'Free Weights' },
    { name: 'Weight Plates', emoji: '‚öôÔ∏è', category: 'Free Weights' },
    
    // Benches
    { name: 'Flat Bench', emoji: 'ü™ë', category: 'Benches' },
    { name: 'Adjustable Bench', emoji: 'üõãÔ∏è', category: 'Benches' },
    
    // Racks & All-in-One
    { name: 'Squat Rack', emoji: 'ü¶µ', category: 'Racks' },
    { name: 'Power Rack', emoji: 'üèóÔ∏è', category: 'Racks' },
    { name: 'Smith Machine', emoji: 'üîß', category: 'Machines' },
    { name: 'All-in-One Home Gym', emoji: 'üèõÔ∏è', category: 'Machines' },
    
    // Cable Systems
    { name: 'Cable Machine', emoji: 'üîå', category: 'Cables' },
    { name: 'Functional Trainer', emoji: 'üéØ', category: 'Cables' },
    
    // Bars & Bodyweight
    { name: 'Pull-up Bar', emoji: 'üî•', category: 'Bodyweight' },
    { name: 'Dip Station', emoji: 'üí∫', category: 'Bodyweight' },
    
    // Leg Machines
    { name: 'Leg Extension Machine', emoji: 'ü¶ø', category: 'Leg Machines' },
    { name: 'Leg Curl Machine', emoji: 'ü¶µ', category: 'Leg Machines' },
    { name: 'Leg Press Machine', emoji: 'üèãÔ∏è‚Äç‚ôÇÔ∏è', category: 'Leg Machines' },
    
    // Specialty
    { name: 'Landmine Attachment', emoji: '‚õèÔ∏è', category: 'Specialty' },
    { name: 'Suspension Trainer (TRX)', emoji: 'ü™¢', category: 'Specialty' },
    { name: 'Resistance Bands', emoji: 'üéóÔ∏è', category: 'Specialty' },
    { name: 'Battle Ropes', emoji: 'ü™¢', category: 'Specialty' },
    
    // Cardio
    { name: 'Walking Pad', emoji: 'üö∂', category: 'Cardio' },
    { name: 'Treadmill', emoji: 'üèÉ', category: 'Cardio' },
    { name: 'Exercise Bike', emoji: 'üö¥', category: 'Cardio' },
    { name: 'Rowing Machine', emoji: 'üö£', category: 'Cardio' },
    { name: 'Elliptical', emoji: 'üéø', category: 'Cardio' },
    
    // Core/Accessories
    { name: 'Ab Wheel', emoji: '‚≠ï', category: 'Accessories' },
    { name: 'Medicine Ball', emoji: '‚öΩ', category: 'Accessories' },
    { name: 'Foam Roller', emoji: 'üåÄ', category: 'Accessories' },
    
    // No Equipment
    { name: 'No Equipment', emoji: 'ü§∏', category: 'Bodyweight' }
  ]

  const popularGyms = [
    '24 Hour Fitness',
    'Anytime Fitness',
    'Crunch Fitness',
    'Equinox',
    'Gold\'s Gym',
    'LA Fitness',
    'Lifetime Fitness',
    'Planet Fitness',
    'Other (specify below)'
  ]

  if (initialLoading) {
    return (
      <div 
        className="min-h-screen flex items-center justify-center"
        style={{ background: 'var(--bgPrimary)' }}
      >
        <p style={{ color: 'var(--textPrimary)' }}>Loading...</p>
      </div>
    )
  }

  return (
    <div 
      className="min-h-screen flex items-center justify-center p-8 transition-all duration-500"
      style={{ background: 'var(--bgPrimary)' }}
    >
      <div className="w-full max-w-2xl space-y-8">
        
        <div className="text-center space-y-2">
          <h1 
            className="text-4xl font-bold"
            style={{
              background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              backgroundClip: 'text',
            }}
          >
            {isEditing ? "Update Your Profile ‚úèÔ∏è" : "Alright, let's get to know you! üëã"}
          </h1>
          <p style={{ color: 'var(--textSecondary)' }}>
            {currentStep === 1 && "No judgment, just facts. We need the basics."}
            {currentStep === 2 && "What's the one thing you want most? Pick your mission."}
            {currentStep === 3 && "This helps us not kill you on Day 1 üòÖ"}
            {currentStep === 4 && "Where will you train and what do you have?"}
          </p>
        </div>

        <div className="space-y-2">
          <div className="flex justify-between text-sm" style={{ color: 'var(--textSecondary)' }}>
            <span>Step {currentStep} of 4</span>
            <span>{currentStep * 25}% there!</span>
          </div>
          <div 
            className="w-full h-2 rounded-full overflow-hidden"
            style={{ backgroundColor: 'var(--bgSecondary)' }}
          >
            <div 
              className="h-full transition-all duration-500"
              style={{
                width: `${currentStep * 25}%`,
                background: `linear-gradient(90deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
              }}
            />
          </div>
        </div>

        <div
          className="themed-card p-8 border-2 space-y-6"
          style={{
            backgroundColor: 'var(--bgCard)',
            borderColor: 'var(--borderColor)',
          }}
        >
          
          {currentStep === 1 && (
            <div className="space-y-6">
              {/* NAME */}
              <div className="space-y-2">
                <label className="block text-sm font-semibold" style={{ color: 'var(--textPrimary)' }}>
                  What should we call you?
                </label>
                <input
                  type="text"
                  value={formData.full_name}
                  onChange={(e) => handleInputChange('full_name', e.target.value)}
                  className="w-full px-4 py-3 rounded-lg border-2 transition-all duration-300"
                  style={{
                    backgroundColor: 'var(--bgSecondary)',
                    borderColor: 'var(--borderColor)',
                    color: 'var(--textPrimary)',
                  }}
                  placeholder="Your actual name (we won't share it!)"
                />
              </div>

              {/* AGE */}
              <div className="space-y-2">
                <label className="block text-sm font-semibold" style={{ color: 'var(--textPrimary)' }}>
                  How many trips around the sun?
                </label>
                <input
                  type="number"
                  value={formData.age}
                  onChange={(e) => handleInputChange('age', e.target.value)}
                  className="w-full px-4 py-3 rounded-lg border-2 transition-all duration-300"
                  style={{
                    backgroundColor: 'var(--bgSecondary)',
                    borderColor: 'var(--borderColor)',
                    color: 'var(--textPrimary)',
                  }}
                  placeholder="Be honest - your body knows üòâ"
                  min="13"
                  max="120"
                />
              </div>

              {/* GENDER */}
              <div className="space-y-2">
                <label className="block text-sm font-semibold" style={{ color: 'var(--textPrimary)' }}>
                  Gender (helps with workout recommendations)
                </label>
                <div className="grid grid-cols-3 gap-3">
                  {['Male', 'Female', 'Other'].map((gender) => (
                    <button
                      key={gender}
                      type="button"
                      onClick={() => handleInputChange('gender', gender)}
                      className="px-4 py-3 rounded-lg border-2 font-semibold transition-all duration-300 hover:scale-105"
                      style={{
                        backgroundColor: formData.gender === gender ? 'var(--accent1)' : 'var(--bgSecondary)',
                        borderColor: formData.gender === gender ? 'var(--accent1)' : 'var(--borderColor)',
                        color: formData.gender === gender ? '#FFFFFF' : 'var(--textPrimary)',
                      }}
                    >
                      {gender}
                    </button>
                  ))}
                </div>
              </div>

              {/* HEIGHT */}
              <div className="space-y-2">
                <label className="block text-sm font-semibold" style={{ color: 'var(--textPrimary)' }}>
                  Your Height üìè
                </label>
                <div className="flex gap-3">
                  <div className="flex-1">
                    <input
                      type="number"
                      placeholder="Feet"
                      value={heightFeet}
                      onChange={(e) => setHeightFeet(e.target.value)}
                      min="4"
                      max="7"
                      className="w-full px-4 py-3 rounded-lg border-2"
                      style={{
                        backgroundColor: 'var(--bgSecondary)',
                        borderColor: 'var(--borderColor)',
                        color: 'var(--textPrimary)',
                      }}
                    />
                    <p className="text-xs mt-1" style={{ color: 'var(--textSecondary)' }}>
                      Feet (4-7)
                    </p>
                  </div>
                  <div className="flex-1">
                    <input
                      type="number"
                      placeholder="Inches"
                      value={heightInches}
                      onChange={(e) => setHeightInches(e.target.value)}
                      min="0"
                      max="11"
                      className="w-full px-4 py-3 rounded-lg border-2"
                      style={{
                        backgroundColor: 'var(--bgSecondary)',
                        borderColor: 'var(--borderColor)',
                        color: 'var(--textPrimary)',
                      }}
                    />
                    <p className="text-xs mt-1" style={{ color: 'var(--textSecondary)' }}>
                      Inches (0-11)
                    </p>
                  </div>
                </div>
                <p className="text-xs" style={{ color: 'var(--textSecondary)' }}>
                  Example: 5 feet, 10 inches = 5'10"
                </p>
              </div>

              {/* CURRENT WEIGHT */}
              <div className="space-y-2">
                <label className="block text-sm font-semibold" style={{ color: 'var(--textPrimary)' }}>
                  Current Weight ‚öñÔ∏è
                </label>
                <div className="flex gap-3">
                  <div className="flex-1">
                    <input
                      type="number"
                      placeholder="Weight"
                      value={currentWeight}
                      onChange={(e) => setCurrentWeight(e.target.value)}
                      step="0.1"
                      min="50"
                      className="w-full px-4 py-3 rounded-lg border-2"
                      style={{
                        backgroundColor: 'var(--bgSecondary)',
                        borderColor: 'var(--borderColor)',
                        color: 'var(--textPrimary)',
                      }}
                    />
                  </div>
                  <select 
                    value={weightUnit} 
                    onChange={(e) => setWeightUnit(e.target.value as 'lbs' | 'kg')}
                    className="px-4 py-3 rounded-lg border-2"
                    style={{
                      backgroundColor: 'var(--bgSecondary)',
                      borderColor: 'var(--borderColor)',
                      color: 'var(--textPrimary)',
                    }}
                  >
                    <option value="lbs">lbs</option>
                    <option value="kg">kg</option>
                  </select>
                </div>
                <p className="text-xs" style={{ color: 'var(--textSecondary)' }}>
                  Be honest - this helps us create the best plan for you üéØ
                </p>
              </div>

              {/* GOAL WEIGHT */}
              <div className="space-y-2">
                <label className="block text-sm font-semibold" style={{ color: 'var(--textPrimary)' }}>
                  Goal Weight (Optional)
                </label>
                <input
                  type="number"
                  placeholder="Target weight"
                  value={goalWeight}
                  onChange={(e) => setGoalWeight(e.target.value)}
                  step="0.1"
                  className="w-full px-4 py-3 rounded-lg border-2"
                  style={{
                    backgroundColor: 'var(--bgSecondary)',
                    borderColor: 'var(--borderColor)',
                    color: 'var(--textPrimary)',
                  }}
                />
                <p className="text-xs" style={{ color: 'var(--textSecondary)' }}>
                  üí° Leave blank if you're focusing on body composition, not the scale
                </p>
              </div>
            </div>
          )}

          {currentStep === 2 && (
            <div className="space-y-6">
              <div className="grid gap-3">
                {[
                  { goal: 'Lose Weight', sub: 'Get lean, feel lighter, drop fat', emoji: 'üî•' },
                  { goal: 'Build Muscle', sub: 'Pack on size, look jacked, get swole', emoji: 'üí™' },
                  { goal: 'Get Stronger', sub: 'Lift heavy, hit PRs, feel powerful', emoji: '‚ö°' },
                  { goal: 'Improve Endurance', sub: "Run longer, don't get winded, beast mode", emoji: 'üèÉ' },
                  { goal: 'General Fitness', sub: 'Just be healthier and feel good overall', emoji: '‚ú®' },
                  { goal: 'Athletic Performance', sub: 'Compete, dominate, win at sports', emoji: 'üèÜ' }
                ].map((item) => (
                  <button
                    key={item.goal}
                    type="button"
                    onClick={() => handleInputChange('fitness_goal', item.goal)}
                    className="px-6 py-4 rounded-lg border-2 text-left transition-all duration-300 hover:scale-102"
                    style={{
                      backgroundColor: formData.fitness_goal === item.goal ? 'var(--accent1)' : 'var(--bgSecondary)',
                      borderColor: formData.fitness_goal === item.goal ? 'var(--accent1)' : 'var(--borderColor)',
                      color: formData.fitness_goal === item.goal ? '#FFFFFF' : 'var(--textPrimary)',
                    }}
                  >
                    <div className="flex items-center gap-3">
                      <span className="text-2xl">{item.emoji}</span>
                      <div className="flex-1">
                        <div className="font-bold">{item.goal}</div>
                        <div 
                          className="text-sm"
                          style={{ 
                            color: formData.fitness_goal === item.goal ? 'rgba(255,255,255,0.9)' : 'var(--textSecondary)' 
                          }}
                        >
                          {item.sub}
                        </div>
                      </div>
                    </div>
                  </button>
                ))}
              </div>
            </div>
          )}

          {currentStep === 3 && (
            <div className="space-y-6">
              <div className="grid gap-3">
                {[
                  { level: 'Beginner', desc: 'New to this, ready to learn', emoji: 'üå±', sub: "(Don't worry - everyone starts here!)" },
                  { level: 'Intermediate', desc: '1-2 years in, got the basics down', emoji: 'üí™', sub: "(You know what a burpee is and hate it)" },
                  { level: 'Advanced', desc: '3+ years, you live this lifestyle', emoji: 'üî•', sub: "(Gym is basically your second home)" },
                  { level: 'Expert', desc: 'Coach/athlete level, you could teach this', emoji: 'üèÜ', sub: "(People ask YOU for fitness advice)" }
                ].map((item) => (
                  <button
                    key={item.level}
                    type="button"
                    onClick={() => handleInputChange('experience_level', item.level)}
                    className="px-6 py-4 rounded-lg border-2 text-left transition-all duration-300 hover:scale-102"
                    style={{
                      backgroundColor: formData.experience_level === item.level ? 'var(--accent1)' : 'var(--bgSecondary)',
                      borderColor: formData.experience_level === item.level ? 'var(--accent1)' : 'var(--borderColor)',
                      color: formData.experience_level === item.level ? '#FFFFFF' : 'var(--textPrimary)',
                    }}
                  >
                    <div className="flex items-start gap-3">
                      <span className="text-2xl">{item.emoji}</span>
                      <div className="flex-1">
                        <div className="font-bold text-lg">{item.level}</div>
                        <div 
                          className="text-sm mt-1"
                          style={{ 
                            color: formData.experience_level === item.level ? 'rgba(255,255,255,0.9)' : 'var(--textSecondary)' 
                          }}
                        >
                          {item.desc}
                        </div>
                        <div 
                          className="text-xs mt-1 italic"
                          style={{ 
                            color: formData.experience_level === item.level ? 'rgba(255,255,255,0.8)' : 'var(--textSecondary)' 
                          }}
                        >
                          {item.sub}
                        </div>
                      </div>
                    </div>
                  </button>
                ))}
              </div>
            </div>
          )}

          {currentStep === 4 && (
            <div className="space-y-6">
              
              {/* TRAINING LOCATION */}
              <div className="space-y-3">
                <h3 className="text-xl font-bold" style={{ color: 'var(--textPrimary)' }}>
                  Where will you train? üèãÔ∏è
                </h3>
                <div className="grid gap-3">
                  {[
                    { loc: 'commercial', name: 'Commercial Gym', sub: 'Full gym access (24 Hour, Planet Fitness, etc)', emoji: 'üè¢' },
                    { loc: 'home', name: 'Home Gym', sub: 'Training at home with your equipment', emoji: 'üè†' },
                    { loc: 'outdoor', name: 'Outdoor/Park', sub: 'Parks, trails, outdoor spaces', emoji: 'üå≥' },
                    { loc: 'minimal', name: 'Limited Space', sub: 'Apartment, dorm, small space', emoji: 'üì¶' }
                  ].map((item) => (
                    <button
                      key={item.loc}
                      type="button"
                      onClick={() => handleInputChange('training_location', item.loc)}
                      className="px-6 py-3 rounded-lg border-2 text-left transition-all duration-300 hover:scale-102"
                      style={{
                        backgroundColor: formData.training_location === item.loc ? 'var(--accent1)' : 'var(--bgSecondary)',
                        borderColor: formData.training_location === item.loc ? 'var(--accent1)' : 'var(--borderColor)',
                        color: formData.training_location === item.loc ? '#FFFFFF' : 'var(--textPrimary)',
                      }}
                    >
                      <div className="flex items-center gap-3">
                        <span className="text-xl">{item.emoji}</span>
                        <div className="flex-1">
                          <div className="font-semibold">{item.name}</div>
                          <div 
                            className="text-sm"
                            style={{ 
                              color: formData.training_location === item.loc ? 'rgba(255,255,255,0.9)' : 'var(--textSecondary)' 
                            }}
                          >
                            {item.sub}
                          </div>
                        </div>
                      </div>
                    </button>
                  ))}
                </div>
              </div>

              {/* GYM CHAIN (if commercial) */}
              {formData.training_location === 'commercial' && (
                <div className="space-y-3">
                  <h3 className="text-lg font-bold" style={{ color: 'var(--textPrimary)' }}>
                    Which gym? üíº
                  </h3>
                  <select
                    value={formData.gym_chain}
                    onChange={(e) => handleInputChange('gym_chain', e.target.value)}
                    className="w-full px-4 py-3 rounded-lg border-2"
                    style={{
                      backgroundColor: 'var(--bgSecondary)',
                      borderColor: 'var(--borderColor)',
                      color: 'var(--textPrimary)',
                    }}
                  >
                    <option value="">Select your gym...</option>
                    {popularGyms.map(gym => (
                      <option key={gym} value={gym}>{gym}</option>
                    ))}
                  </select>
                  
                  {(formData.gym_chain === 'Other (specify below)' || formData.gym_chain === '') && (
                    <input
                      type="text"
                      placeholder="Enter your gym name..."
                      value={formData.gym_custom_name}
                      onChange={(e) => handleInputChange('gym_custom_name', e.target.value)}
                      className="w-full px-4 py-3 rounded-lg border-2"
                      style={{
                        backgroundColor: 'var(--bgSecondary)',
                        borderColor: 'var(--borderColor)',
                        color: 'var(--textPrimary)',
                      }}
                    />
                  )}
                </div>
              )}

              {/* EQUIPMENT (if not commercial) */}
              {formData.training_location !== 'commercial' && formData.training_location !== '' && (
                <div className="space-y-4">
                  <h3 className="text-lg font-bold" style={{ color: 'var(--textPrimary)' }}>
                    What equipment do you have? üí™
                  </h3>
                  <p className="text-sm" style={{ color: 'var(--textSecondary)' }}>
                    Pick all that apply - we have 31 options including Walking Pad, Smith Machines, Leg Machines, and more!
                  </p>

                  <div className="grid grid-cols-2 gap-3 max-h-96 overflow-y-auto p-2">
                    {equipmentOptions.map((item) => (
                      <button
                        key={item.name}
                        type="button"
                        onClick={() => handleEquipmentToggle(item.name)}
                        className="px-4 py-3 rounded-lg border-2 font-semibold transition-all duration-300 hover:scale-105 text-left"
                        style={{
                          backgroundColor: formData.available_equipment.includes(item.name) ? 'var(--accent1)' : 'var(--bgSecondary)',
                          borderColor: formData.available_equipment.includes(item.name) ? 'var(--accent1)' : 'var(--borderColor)',
                          color: formData.available_equipment.includes(item.name) ? '#FFFFFF' : 'var(--textPrimary)',
                        }}
                      >
                        <span className="mr-2">{item.emoji}</span>
                        {item.name}
                      </button>
                    ))}
                  </div>
                  
                  {formData.available_equipment.length > 0 && (
                    <p className="text-sm" style={{ color: 'var(--accent1)' }}>
                      ‚úì Selected {formData.available_equipment.length} item(s)
                    </p>
                  )}
                </div>
              )}

              {/* WORKOUT FREQUENCY */}
              <div className="space-y-3">
                <div>
                  <h3 
                    className="text-xl font-bold"
                    style={{ color: 'var(--textPrimary)' }}
                  >
                    How many days can you REALISTICALLY commit?
                  </h3>
                  <p className="text-sm mt-1" style={{ color: 'var(--textSecondary)' }}>
                    Be honest - we'd rather you crush 3 days than skip 6!
                  </p>
                </div>

                <div className="grid gap-3">
                  {[
                    { freq: '1-2 days per week', sub: 'Just starting or super busy', emoji: 'üå±' },
                    { freq: '3-4 days per week', sub: 'The sweet spot for most people', emoji: 'üí™' },
                    { freq: '5-6 days per week', sub: 'You mean business', emoji: 'üî•' },
                    { freq: 'Every day', sub: 'Absolute savage mode', emoji: 'üèÜ' }
                  ].map((item) => (
                    <button
                      key={item.freq}
                      type="button"
                      onClick={() => handleInputChange('workout_frequency', item.freq)}
                      className="px-6 py-3 rounded-lg border-2 text-left transition-all duration-300 hover:scale-102"
                      style={{
                        backgroundColor: formData.workout_frequency === item.freq ? 'var(--accent1)' : 'var(--bgSecondary)',
                        borderColor: formData.workout_frequency === item.freq ? 'var(--accent1)' : 'var(--borderColor)',
                        color: formData.workout_frequency === item.freq ? '#FFFFFF' : 'var(--textPrimary)',
                      }}
                    >
                      <div className="flex items-center gap-3">
                        <span className="text-xl">{item.emoji}</span>
                        <div className="flex-1">
                          <div className="font-semibold">{item.freq}</div>
                          <div 
                            className="text-sm"
                            style={{ 
                              color: formData.workout_frequency === item.freq ? 'rgba(255,255,255,0.9)' : 'var(--textSecondary)' 
                            }}
                          >
                            {item.sub}
                          </div>
                        </div>
                      </div>
                    </button>
                  ))}
                </div>
              </div>
            </div>
          )}

          {error && (
            <div 
              className="p-4 rounded-lg border-2"
              style={{
                backgroundColor: 'rgba(239, 68, 68, 0.1)',
                borderColor: '#EF4444',
                color: '#EF4444',
              }}
            >
              {error}
            </div>
          )}

          <div className="flex gap-4 pt-4">
            {currentStep > 1 && (
              <button
                onClick={handleBack}
                className="px-6 py-3 rounded-lg font-bold border-2 transition-all duration-300 hover:opacity-80"
                style={{
                  borderColor: 'var(--borderColor)',
                  color: 'var(--textPrimary)',
                }}
              >
                ‚Üê Back
              </button>
            )}
            
            {currentStep < 4 ? (
              <button
                onClick={handleNext}
                className="flex-1 px-6 py-3 rounded-lg font-bold transition-all duration-300 hover:scale-105"
                style={{
                  background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                  color: '#FFFFFF',
                }}
              >
                Next ‚Üí
              </button>
            ) : (
              <button
                onClick={handleSubmit}
                disabled={loading}
                className="flex-1 px-6 py-3 rounded-lg font-bold transition-all duration-300 hover:scale-105"
                style={{
                  background: `linear-gradient(135deg, ${themeConfig.colors.accent1}, ${themeConfig.colors.accent2})`,
                  color: '#FFFFFF',
                  opacity: loading ? 0.7 : 1,
                  cursor: loading ? 'not-allowed' : 'pointer',
                }}
              >
                {loading ? 'Saving your profile...' : isEditing ? "Update Profile üíæ" : "Let's Go! üöÄ"}
              </button>
            )}
          </div>
        </div>
      </div>
    </div>
  )
}
</file>

</files>
